/*** Autogenerated by WIDL 3.8 from sti_wia.idl - Do not edit ***/

#define __midl_proxy
#include "objbase.h"

#ifndef DECLSPEC_HIDDEN
#define DECLSPEC_HIDDEN
#endif


#ifndef _WIN64

#ifndef __REDQ_RPCPROXY_H_VERSION__
#define __REQUIRED_RPCPROXY_H_VERSION__ 440
#endif

#include "rpcproxy.h"
#ifndef __RPCPROXY_H_VERSION__
#error This code needs a newer version of rpcproxy.h
#endif /* __RPCPROXY_H_VERSION__ */

#include "sti_wia.h"

#ifndef USE_COMPILER_EXCEPTIONS

#include "wine/exception.h"
#undef RpcTryExcept
#undef RpcExcept
#undef RpcEndExcept
#undef RpcTryFinally
#undef RpcFinally
#undef RpcEndFinally
#undef RpcExceptionCode
#undef RpcAbnormalTermination

struct __exception_frame;
typedef int (*__filter_func)(struct __exception_frame *);
typedef void (*__finally_func)(struct __exception_frame *);

#define __DECL_EXCEPTION_FRAME \
    EXCEPTION_REGISTRATION_RECORD frame; \
    __filter_func                 filter; \
    __finally_func                finally; \
    sigjmp_buf                    jmp; \
    DWORD                         code; \
    unsigned char                 abnormal_termination; \
    unsigned char                 filter_level; \
    unsigned char                 finally_level;

struct __exception_frame
{
    __DECL_EXCEPTION_FRAME
};

static inline void __widl_unwind_target(void)
{
    struct __exception_frame *exc_frame = (struct __exception_frame *)__wine_get_frame();
    if (exc_frame->finally_level > exc_frame->filter_level)
    {
        exc_frame->abnormal_termination = 1;
        exc_frame->finally( exc_frame );
        __wine_pop_frame( &exc_frame->frame );
    }
    exc_frame->filter_level = 0;
    siglongjmp( exc_frame->jmp, 1 );
}

static DWORD __widl_exception_handler( EXCEPTION_RECORD *record,
                                       EXCEPTION_REGISTRATION_RECORD *frame,
                                       CONTEXT *context,
                                       EXCEPTION_REGISTRATION_RECORD **pdispatcher )
{
    struct __exception_frame *exc_frame = (struct __exception_frame *)frame;

    if (record->ExceptionFlags & (EH_UNWINDING | EH_EXIT_UNWIND | EH_NESTED_CALL))
    {
        if (exc_frame->finally_level && (record->ExceptionFlags & (EH_UNWINDING | EH_EXIT_UNWIND)))
        {
            exc_frame->abnormal_termination = 1;
            exc_frame->finally( exc_frame );
        }
        return ExceptionContinueSearch;
    }
    exc_frame->code = record->ExceptionCode;
    if (exc_frame->filter_level && exc_frame->filter( exc_frame ) == EXCEPTION_EXECUTE_HANDLER)
        __wine_rtl_unwind( frame, record, __widl_unwind_target );
    return ExceptionContinueSearch;
}

#define RpcTryExcept \
    if (!sigsetjmp( __frame->jmp, 0 )) \
    { \
        if (!__frame->finally_level) \
            __wine_push_frame( &__frame->frame ); \
        __frame->filter_level = __frame->finally_level + 1;

#define RpcExcept(expr) \
        if (!__frame->finally_level) \
            __wine_pop_frame( &__frame->frame ); \
        __frame->filter_level = 0; \
    } \
    else \

#define RpcEndExcept

#define RpcExceptionCode() (__frame->code)

#define RpcTryFinally \
    if (!__frame->filter_level) \
        __wine_push_frame( &__frame->frame ); \
    __frame->finally_level = __frame->filter_level + 1;

#define RpcFinally \
    if (!__frame->filter_level) \
        __wine_pop_frame( &__frame->frame ); \
    __frame->finally_level = 0;

#define RpcEndFinally

#define RpcAbnormalTermination() (__frame->abnormal_termination)

#define RpcExceptionInit(filter_func,finally_func) \
    do { \
        __frame->frame.Handler = __widl_exception_handler; \
        __frame->filter = (__filter_func)(filter_func); \
        __frame->finally = (__finally_func)(finally_func); \
        __frame->abnormal_termination = 0; \
        __frame->filter_level = 0; \
        __frame->finally_level = 0; \
    } while (0)

#else /* USE_COMPILER_EXCEPTIONS */

#define RpcExceptionInit(filter_func,finally_func) \
    do { (void)(filter_func); } while(0)

#define __DECL_EXCEPTION_FRAME \
    DWORD code;

#endif /* USE_COMPILER_EXCEPTIONS */

struct __proxy_frame
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    void             *This;
};

static int __proxy_filter( struct __proxy_frame *__frame )
{
    return (__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE);
}

#define TYPE_FORMAT_STRING_SIZE 599
#define PROC_FORMAT_STRING_SIZE 219

typedef struct _MIDL_TYPE_FORMAT_STRING
{
    short Pad;
    unsigned char Format[TYPE_FORMAT_STRING_SIZE];
} MIDL_TYPE_FORMAT_STRING;

typedef struct _MIDL_PROC_FORMAT_STRING
{
    short Pad;
    unsigned char Format[PROC_FORMAT_STRING_SIZE];
} MIDL_PROC_FORMAT_STRING;


static const MIDL_TYPE_FORMAT_STRING __MIDL_TypeFormatString;
static const MIDL_PROC_FORMAT_STRING __MIDL_ProcFormatString;

static const MIDL_STUB_DESC Object_StubDesc;

/*****************************************************************************
 * IWiaDevMgr interface
 */
static void __finally_IWiaDevMgr_EnumDeviceInfo_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_EnumDeviceInfo_Proxy(
    IWiaDevMgr* This,
    LONG lFlag,
    IEnumWIA_DEV_INFO **ppIEnum)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_EnumDeviceInfo_Proxy );
    __frame->This = This;
    if (ppIEnum) MIDL_memset( ppIEnum, 0, sizeof( *ppIEnum ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 3);
        if (!ppIEnum) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlag;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[0]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppIEnum,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_EnumDeviceInfo_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[20], (void *)ppIEnum );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_EnumDeviceInfo_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlag;
    IEnumWIA_DEV_INFO *_W0;
    IEnumWIA_DEV_INFO ** ppIEnum;
};

static void __finally_IWiaDevMgr_EnumDeviceInfo_Stub( struct __frame_IWiaDevMgr_EnumDeviceInfo_Stub *__frame )
{

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppIEnum,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20]);

}

void __RPC_STUB IWiaDevMgr_EnumDeviceInfo_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_EnumDeviceInfo_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_EnumDeviceInfo_Stub );
    __frame->ppIEnum = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[0]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlag = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);


        __frame->ppIEnum = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->EnumDeviceInfo(__frame->_This, __frame->lFlag, __frame->ppIEnum);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_EnumDeviceInfo_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_CreateDevice_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_CreateDevice_Proxy(
    IWiaDevMgr* This,
    BSTR bstrDeviceID,
    IWiaItem **ppWiaItemRoot)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_CreateDevice_Proxy );
    __frame->This = This;
    if (ppWiaItemRoot) MIDL_memset( ppWiaItemRoot, 0, sizeof( *ppWiaItemRoot ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 4);
        if (!ppWiaItemRoot) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[8]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppWiaItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_CreateDevice_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[76], (void *)ppWiaItemRoot );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_CreateDevice_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    IWiaItem *_W0;
    IWiaItem ** ppWiaItemRoot;
};

static void __finally_IWiaDevMgr_CreateDevice_Stub( struct __frame_IWiaDevMgr_CreateDevice_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48]);

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppWiaItemRoot,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76]);

}

void __RPC_STUB IWiaDevMgr_CreateDevice_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_CreateDevice_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_CreateDevice_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->ppWiaItemRoot = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[8]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48],
            0);


        __frame->ppWiaItemRoot = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->CreateDevice(__frame->_This, __frame->bstrDeviceID, __frame->ppWiaItemRoot);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppWiaItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppWiaItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_CreateDevice_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_SelectDeviceDlg_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_SelectDeviceDlg_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lDeviceType,
    LONG lFlags,
    BSTR *pbstrDeviceID,
    IWiaItem **ppItemRoot)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_SelectDeviceDlg_Proxy );
    __frame->This = This;
    if (ppItemRoot) MIDL_memset( ppItemRoot, 0, sizeof( *ppItemRoot ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 5);
        if (!ppItemRoot) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 16;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104]);

            NdrPointerBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lDeviceType;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrPointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[18]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124],
                0);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_SelectDeviceDlg_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[124], (void *)pbstrDeviceID );

        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[146], (void *)ppItemRoot );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_SelectDeviceDlg_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lDeviceType;
    LONG lFlags;
    BSTR * pbstrDeviceID;
    IWiaItem *_W0;
    IWiaItem ** ppItemRoot;
};

static void __finally_IWiaDevMgr_SelectDeviceDlg_Stub( struct __frame_IWiaDevMgr_SelectDeviceDlg_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104]);



    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pbstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppItemRoot,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146]);

}

void __RPC_STUB IWiaDevMgr_SelectDeviceDlg_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_SelectDeviceDlg_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_SelectDeviceDlg_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;
    __frame->pbstrDeviceID = 0;
    __frame->ppItemRoot = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[18]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lDeviceType = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrPointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124],
            0);


        __frame->ppItemRoot = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->SelectDeviceDlg(__frame->_This, __frame->hwndParent, __frame->lDeviceType, __frame->lFlags, __frame->pbstrDeviceID, __frame->ppItemRoot);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_SelectDeviceDlg_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_SelectDeviceDlgID_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_SelectDeviceDlgID_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lDeviceType,
    LONG lFlags,
    BSTR *pbstrDeviceID)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_SelectDeviceDlgID_Proxy );
    __frame->This = This;
    if (pbstrDeviceID) MIDL_memset( pbstrDeviceID, 0, sizeof( *pbstrDeviceID ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 6);
        if (!pbstrDeviceID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 16;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lDeviceType;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[36]);

            NdrUserMarshalUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[114],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_SelectDeviceDlgID_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[160], (void *)pbstrDeviceID );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_SelectDeviceDlgID_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lDeviceType;
    LONG lFlags;
    BSTR _W0;
    BSTR * pbstrDeviceID;
};

static void __finally_IWiaDevMgr_SelectDeviceDlgID_Stub( struct __frame_IWiaDevMgr_SelectDeviceDlgID_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150]);



    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pbstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[160]);

}

void __RPC_STUB IWiaDevMgr_SelectDeviceDlgID_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_SelectDeviceDlgID_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_SelectDeviceDlgID_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;
    __frame->pbstrDeviceID = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[36]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lDeviceType = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);


        __frame->pbstrDeviceID = &__frame->_W0;
        memset(&__frame->_W0, 0, sizeof(__frame->_W0));

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->SelectDeviceDlgID(__frame->_This, __frame->hwndParent, __frame->lDeviceType, __frame->lFlags, __frame->pbstrDeviceID);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrUserMarshalBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[114]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrUserMarshalMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[114]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_SelectDeviceDlgID_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_GetImageDlg_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_GetImageDlg_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lDeviceType,
    LONG lFlags,
    LONG lIntent,
    IWiaItem *pItemRoot,
    BSTR bstrFilename,
    GUID *pguidFormat)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_GetImageDlg_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 7);
        if (!pguidFormat) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 44;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164]);

            NdrInterfacePointerBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)pItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFilename,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lDeviceType;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lIntent;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrInterfacePointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFilename,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pguidFormat,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[50]);

            NdrSimpleStructUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pguidFormat,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_GetImageDlg_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[220], (void *)pguidFormat );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_GetImageDlg_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lDeviceType;
    LONG lFlags;
    LONG lIntent;
    IWiaItem * pItemRoot;
    BSTR bstrFilename;
    void *_p_bstrFilename;
    GUID * pguidFormat;
};

static void __finally_IWiaDevMgr_GetImageDlg_Stub( struct __frame_IWiaDevMgr_GetImageDlg_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164]);




    NdrInterfacePointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pItemRoot,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrFilename,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192]);


}

void __RPC_STUB IWiaDevMgr_GetImageDlg_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_GetImageDlg_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_GetImageDlg_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;
    __frame->pItemRoot = 0;
    MIDL_memset(&__frame->bstrFilename, 0, sizeof(__frame->bstrFilename));
    __frame->_p_bstrFilename = &__frame->bstrFilename;
    __frame->pguidFormat = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[50]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lDeviceType = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lIntent = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrInterfacePointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrFilename,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pguidFormat,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208],
            0);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->GetImageDlg(__frame->_This, __frame->hwndParent, __frame->lDeviceType, __frame->lFlags, __frame->lIntent, __frame->pItemRoot, __frame->bstrFilename, __frame->pguidFormat);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 28;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrSimpleStructMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pguidFormat,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_GetImageDlg_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_RegisterEventCallbackProgram_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_RegisterEventCallbackProgram_Proxy(
    IWiaDevMgr* This,
    LONG lFlags,
    BSTR bstrDeviceID,
    const GUID *pEventGUID,
    BSTR bstrCommandline,
    BSTR bstrName,
    BSTR bstrDescription,
    BSTR bstrIcon)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_RegisterEventCallbackProgram_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 8);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 28;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrCommandline,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[240]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrCommandline,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[74]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_RegisterEventCallbackProgram_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_RegisterEventCallbackProgram_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlags;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    const GUID * pEventGUID;
    BSTR bstrCommandline;
    void *_p_bstrCommandline;
    BSTR bstrName;
    void *_p_bstrName;
    BSTR bstrDescription;
    void *_p_bstrDescription;
    BSTR bstrIcon;
    void *_p_bstrIcon;
};

static void __finally_IWiaDevMgr_RegisterEventCallbackProgram_Stub( struct __frame_IWiaDevMgr_RegisterEventCallbackProgram_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224]);


    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrCommandline,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrName,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrIcon,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286]);

}

void __RPC_STUB IWiaDevMgr_RegisterEventCallbackProgram_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_RegisterEventCallbackProgram_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_RegisterEventCallbackProgram_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->pEventGUID = 0;
    MIDL_memset(&__frame->bstrCommandline, 0, sizeof(__frame->bstrCommandline));
    __frame->_p_bstrCommandline = &__frame->bstrCommandline;
    MIDL_memset(&__frame->bstrName, 0, sizeof(__frame->bstrName));
    __frame->_p_bstrName = &__frame->bstrName;
    MIDL_memset(&__frame->bstrDescription, 0, sizeof(__frame->bstrDescription));
    __frame->_p_bstrDescription = &__frame->bstrDescription;
    MIDL_memset(&__frame->bstrIcon, 0, sizeof(__frame->bstrIcon));
    __frame->_p_bstrIcon = &__frame->bstrIcon;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[74]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[240],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrCommandline,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrName,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrIcon,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286],
            0);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->RegisterEventCallbackProgram(__frame->_This, __frame->lFlags, __frame->bstrDeviceID, __frame->pEventGUID, __frame->bstrCommandline, __frame->bstrName, __frame->bstrDescription, __frame->bstrIcon);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_RegisterEventCallbackProgram_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_RegisterEventCallbackInterface_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_RegisterEventCallbackInterface_Proxy(
    IWiaDevMgr* This,
    LONG lFlags,
    BSTR bstrDeviceID,
    const GUID *pEventGUID,
    IWiaEventCallback *pIWiaEventCallback,
    IUnknown **pEventObject)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_RegisterEventCallbackInterface_Proxy );
    __frame->This = This;
    if (pEventObject) MIDL_memset( pEventObject, 0, sizeof( *pEventObject ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 9);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        if (!pEventObject) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 28;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296]);

            NdrInterfacePointerBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)pIWiaEventCallback,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[312]);

            NdrInterfacePointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pIWiaEventCallback,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[102]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pEventObject,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_RegisterEventCallbackInterface_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[364], (void *)pEventObject );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_RegisterEventCallbackInterface_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlags;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    const GUID * pEventGUID;
    IWiaEventCallback * pIWiaEventCallback;
    IUnknown *_W0;
    IUnknown ** pEventObject;
};

static void __finally_IWiaDevMgr_RegisterEventCallbackInterface_Stub( struct __frame_IWiaDevMgr_RegisterEventCallbackInterface_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296]);


    NdrInterfacePointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pIWiaEventCallback,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328]);

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pEventObject,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364]);

}

void __RPC_STUB IWiaDevMgr_RegisterEventCallbackInterface_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_RegisterEventCallbackInterface_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_RegisterEventCallbackInterface_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->pEventGUID = 0;
    __frame->pIWiaEventCallback = 0;
    __frame->pEventObject = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[102]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[312],
            0);

        NdrInterfacePointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pIWiaEventCallback,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328],
            0);


        __frame->pEventObject = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->RegisterEventCallbackInterface(__frame->_This, __frame->lFlags, __frame->bstrDeviceID, __frame->pEventGUID, __frame->pIWiaEventCallback, __frame->pEventObject);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pEventObject,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pEventObject,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_RegisterEventCallbackInterface_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_RegisterEventCallbackCLSID_Proxy(
    IWiaDevMgr* This,
    LONG lFlags,
    BSTR bstrDeviceID,
    const GUID *pEventGUID,
    const GUID *pClsID,
    BSTR bstrName,
    BSTR bstrDescription,
    BSTR bstrIcon)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 10);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 56;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[384]);

            NdrPointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pClsID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[418]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[122]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_RegisterEventCallbackCLSID_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlags;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    const GUID * pEventGUID;
    const GUID * pClsID;
    BSTR bstrName;
    void *_p_bstrName;
    BSTR bstrDescription;
    void *_p_bstrDescription;
    BSTR bstrIcon;
    void *_p_bstrIcon;
};

static void __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Stub( struct __frame_IWiaDevMgr_RegisterEventCallbackCLSID_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368]);


    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pClsID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[418]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrName,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrIcon,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442]);

}

void __RPC_STUB IWiaDevMgr_RegisterEventCallbackCLSID_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_RegisterEventCallbackCLSID_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->pEventGUID = 0;
    __frame->pClsID = 0;
    MIDL_memset(&__frame->bstrName, 0, sizeof(__frame->bstrName));
    __frame->_p_bstrName = &__frame->bstrName;
    MIDL_memset(&__frame->bstrDescription, 0, sizeof(__frame->bstrDescription));
    __frame->_p_bstrDescription = &__frame->bstrDescription;
    MIDL_memset(&__frame->bstrIcon, 0, sizeof(__frame->bstrIcon));
    __frame->_p_bstrIcon = &__frame->bstrIcon;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[122]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[384],
            0);

        NdrPointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pClsID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[418],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrName,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrIcon,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442],
            0);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->RegisterEventCallbackCLSID(__frame->_This, __frame->lFlags, __frame->bstrDeviceID, __frame->pEventGUID, __frame->pClsID, __frame->bstrName, __frame->bstrDescription, __frame->bstrIcon);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_AddDeviceDlg_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_AddDeviceDlg_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lFlags)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_AddDeviceDlg_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 11);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[150]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_AddDeviceDlg_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_AddDeviceDlg_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lFlags;
};

static void __finally_IWiaDevMgr_AddDeviceDlg_Stub( struct __frame_IWiaDevMgr_AddDeviceDlg_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452]);


}

void __RPC_STUB IWiaDevMgr_AddDeviceDlg_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_AddDeviceDlg_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_AddDeviceDlg_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[150]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->AddDeviceDlg(__frame->_This, __frame->hwndParent, __frame->lFlags);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_AddDeviceDlg_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static const unsigned short IWiaDevMgr_FormatStringOffsetTable[] =
{
    0,  /* IWiaDevMgr::EnumDeviceInfo */
    8,  /* IWiaDevMgr::CreateDevice */
    18,  /* IWiaDevMgr::SelectDeviceDlg */
    36,  /* IWiaDevMgr::SelectDeviceDlgID */
    50,  /* IWiaDevMgr::GetImageDlg */
    74,  /* IWiaDevMgr::RegisterEventCallbackProgram */
    102,  /* IWiaDevMgr::RegisterEventCallbackInterface */
    122,  /* IWiaDevMgr::RegisterEventCallbackCLSID */
    150,  /* IWiaDevMgr::AddDeviceDlg */
};

static const CINTERFACE_PROXY_VTABLE(12) _IWiaDevMgrProxyVtbl =
{
    {
        &IID_IWiaDevMgr,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
        IWiaDevMgr_EnumDeviceInfo_Proxy,
        IWiaDevMgr_CreateDevice_Proxy,
        IWiaDevMgr_SelectDeviceDlg_Proxy,
        IWiaDevMgr_SelectDeviceDlgID_Proxy,
        IWiaDevMgr_GetImageDlg_Proxy,
        IWiaDevMgr_RegisterEventCallbackProgram_Proxy,
        IWiaDevMgr_RegisterEventCallbackInterface_Proxy,
        IWiaDevMgr_RegisterEventCallbackCLSID_Proxy,
        IWiaDevMgr_AddDeviceDlg_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaDevMgr_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaDevMgr_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaDevMgr_table[] =
{
    IWiaDevMgr_EnumDeviceInfo_Stub,
    IWiaDevMgr_CreateDevice_Stub,
    IWiaDevMgr_SelectDeviceDlg_Stub,
    IWiaDevMgr_SelectDeviceDlgID_Stub,
    IWiaDevMgr_GetImageDlg_Stub,
    IWiaDevMgr_RegisterEventCallbackProgram_Stub,
    IWiaDevMgr_RegisterEventCallbackInterface_Stub,
    IWiaDevMgr_RegisterEventCallbackCLSID_Stub,
    IWiaDevMgr_AddDeviceDlg_Stub
};

static const CInterfaceStubVtbl _IWiaDevMgrStubVtbl =
{
    {
        &IID_IWiaDevMgr,
        &IWiaDevMgr_ServerInfo,
        12,
        &IWiaDevMgr_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

/*****************************************************************************
 * IEnumWIA_DEV_INFO interface
 */
static void __finally_IEnumWIA_DEV_INFO_Next_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Next_Proxy(
    IEnumWIA_DEV_INFO* This,
    ULONG celt,
    IWiaPropertyStorage **rgelt,
    ULONG *pceltFetched)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Next_Proxy );
    __frame->This = This;
    if (rgelt) MIDL_memset( rgelt, 0, sizeof( *rgelt ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 3);
        if (!rgelt) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        if (!pceltFetched) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = celt;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[158]);

            NdrComplexArrayUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&rgelt,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[480],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            *pceltFetched = *(ULONG *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Next_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        __frame->_StubMsg.MaxCount = (ULONG_PTR)celt;

        __frame->_StubMsg.Offset = 0;
        __frame->_StubMsg.ActualCount = __frame->_StubMsg.MaxCount;

        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[498], (void *)rgelt );

        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[502], (void *)pceltFetched );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Next_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    ULONG celt;
    IWiaPropertyStorage ** rgelt;
    ULONG _W0;
    ULONG * pceltFetched;
};

static void __finally_IEnumWIA_DEV_INFO_Next_Stub( struct __frame_IEnumWIA_DEV_INFO_Next_Stub *__frame )
{

    __frame->_StubMsg.MaxCount = (ULONG_PTR)__frame->celt;

    __frame->_StubMsg.Offset = 0;
    __frame->_StubMsg.ActualCount = (ULONG_PTR)*__frame->pceltFetched;

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->rgelt,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[498]);


}

void __RPC_STUB IEnumWIA_DEV_INFO_Next_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Next_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Next_Stub );
    __frame->rgelt = 0;
    __frame->pceltFetched = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[158]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->celt = *(ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        __frame->rgelt = NdrAllocate(&__frame->_StubMsg, __frame->celt * 4);
        memset(__frame->rgelt, 0, __frame->celt * 4);
        __frame->pceltFetched = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Next(__frame->_This, __frame->celt, __frame->rgelt, __frame->pceltFetched);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 16;
        __frame->_StubMsg.MaxCount = (ULONG_PTR)__frame->celt;

        __frame->_StubMsg.Offset = 0;
        __frame->_StubMsg.ActualCount = (ULONG_PTR)*__frame->pceltFetched;

        NdrComplexArrayBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->rgelt,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[480]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        __frame->_StubMsg.MaxCount = (ULONG_PTR)__frame->celt;

        __frame->_StubMsg.Offset = 0;
        __frame->_StubMsg.ActualCount = (ULONG_PTR)*__frame->pceltFetched;

        NdrComplexArrayMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->rgelt,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[480]);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(ULONG *)__frame->_StubMsg.Buffer = *__frame->pceltFetched;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Next_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_Skip_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Skip_Proxy(
    IEnumWIA_DEV_INFO* This,
    ULONG celt)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Skip_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 4);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = celt;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[170]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Skip_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Skip_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    ULONG celt;
};

static void __finally_IEnumWIA_DEV_INFO_Skip_Stub( struct __frame_IEnumWIA_DEV_INFO_Skip_Stub *__frame )
{

}

void __RPC_STUB IEnumWIA_DEV_INFO_Skip_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Skip_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Skip_Stub );

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[170]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->celt = *(ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Skip(__frame->_This, __frame->celt);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Skip_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_Reset_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Reset_Proxy(
    IEnumWIA_DEV_INFO* This)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Reset_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 5);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[174]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Reset_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Reset_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
};

static void __finally_IEnumWIA_DEV_INFO_Reset_Stub( struct __frame_IEnumWIA_DEV_INFO_Reset_Stub *__frame )
{
}

void __RPC_STUB IEnumWIA_DEV_INFO_Reset_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Reset_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Reset_Stub );
    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[174]);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Reset(__frame->_This);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Reset_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_Clone_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Clone_Proxy(
    IEnumWIA_DEV_INFO* This,
    IEnumWIA_DEV_INFO **ppIEnum)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Clone_Proxy );
    __frame->This = This;
    if (ppIEnum) MIDL_memset( ppIEnum, 0, sizeof( *ppIEnum ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 6);
        if (!ppIEnum) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[176]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppIEnum,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Clone_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[524], (void *)ppIEnum );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Clone_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    IEnumWIA_DEV_INFO *_W0;
    IEnumWIA_DEV_INFO ** ppIEnum;
};

static void __finally_IEnumWIA_DEV_INFO_Clone_Stub( struct __frame_IEnumWIA_DEV_INFO_Clone_Stub *__frame )
{
    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppIEnum,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524]);

}

void __RPC_STUB IEnumWIA_DEV_INFO_Clone_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Clone_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Clone_Stub );
    __frame->ppIEnum = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[176]);


        __frame->ppIEnum = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Clone(__frame->_This, __frame->ppIEnum);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Clone_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_GetCount_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_GetCount_Proxy(
    IEnumWIA_DEV_INFO* This,
    ULONG *celt)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_GetCount_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 7);
        if (!celt) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[182]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            *celt = *(ULONG *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_GetCount_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[528], (void *)celt );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_GetCount_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    ULONG _W0;
    ULONG * celt;
};

static void __finally_IEnumWIA_DEV_INFO_GetCount_Stub( struct __frame_IEnumWIA_DEV_INFO_GetCount_Stub *__frame )
{

}

void __RPC_STUB IEnumWIA_DEV_INFO_GetCount_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_GetCount_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_GetCount_Stub );
    __frame->celt = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[182]);


        __frame->celt = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->GetCount(__frame->_This, __frame->celt);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 16;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(ULONG *)__frame->_StubMsg.Buffer = *__frame->celt;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_GetCount_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static const unsigned short IEnumWIA_DEV_INFO_FormatStringOffsetTable[] =
{
    158,  /* IEnumWIA_DEV_INFO::Next */
    170,  /* IEnumWIA_DEV_INFO::Skip */
    174,  /* IEnumWIA_DEV_INFO::Reset */
    176,  /* IEnumWIA_DEV_INFO::Clone */
    182,  /* IEnumWIA_DEV_INFO::GetCount */
};

static const CINTERFACE_PROXY_VTABLE(8) _IEnumWIA_DEV_INFOProxyVtbl =
{
    {
        &IID_IEnumWIA_DEV_INFO,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
        IEnumWIA_DEV_INFO_Next_Proxy,
        IEnumWIA_DEV_INFO_Skip_Proxy,
        IEnumWIA_DEV_INFO_Reset_Proxy,
        IEnumWIA_DEV_INFO_Clone_Proxy,
        IEnumWIA_DEV_INFO_GetCount_Proxy,
    }
};

static const MIDL_SERVER_INFO IEnumWIA_DEV_INFO_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IEnumWIA_DEV_INFO_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IEnumWIA_DEV_INFO_table[] =
{
    IEnumWIA_DEV_INFO_Next_Stub,
    IEnumWIA_DEV_INFO_Skip_Stub,
    IEnumWIA_DEV_INFO_Reset_Stub,
    IEnumWIA_DEV_INFO_Clone_Stub,
    IEnumWIA_DEV_INFO_GetCount_Stub
};

static const CInterfaceStubVtbl _IEnumWIA_DEV_INFOStubVtbl =
{
    {
        &IID_IEnumWIA_DEV_INFO,
        &IEnumWIA_DEV_INFO_ServerInfo,
        8,
        &IEnumWIA_DEV_INFO_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

static const unsigned short IWiaPropertyStorage_FormatStringOffsetTable[] =
{
};

static const CINTERFACE_PROXY_VTABLE(3) _IWiaPropertyStorageProxyVtbl =
{
    {
        &IID_IWiaPropertyStorage,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaPropertyStorage_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaPropertyStorage_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaPropertyStorage_table[] =
{

};

static const CInterfaceStubVtbl _IWiaPropertyStorageStubVtbl =
{
    {
        &IID_IWiaPropertyStorage,
        &IWiaPropertyStorage_ServerInfo,
        3,
        &IWiaPropertyStorage_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

static const unsigned short IWiaItem_FormatStringOffsetTable[] =
{
};

static const CINTERFACE_PROXY_VTABLE(3) _IWiaItemProxyVtbl =
{
    {
        &IID_IWiaItem,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaItem_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaItem_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaItem_table[] =
{

};

static const CInterfaceStubVtbl _IWiaItemStubVtbl =
{
    {
        &IID_IWiaItem,
        &IWiaItem_ServerInfo,
        3,
        &IWiaItem_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

/*****************************************************************************
 * IWiaEventCallback interface
 */
static void __finally_IWiaEventCallback_ImageEventCallback_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaEventCallback_ImageEventCallback_Proxy(
    IWiaEventCallback* This,
    const GUID *pEventGUID,
    BSTR bstrEventDescription,
    BSTR bstrDeviceID,
    BSTR bstrDeviceDescription,
    DWORD dwDeviceType,
    BSTR bstrFullItemName,
    ULONG *pulEventType,
    ULONG ulReserved)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaEventCallback_ImageEventCallback_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 3);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        if (!pulEventType) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 44;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrEventDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFullItemName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[538]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrEventDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(DWORD *)__frame->_StubMsg.Buffer = dwDeviceType;
            __frame->_StubMsg.Buffer += sizeof(DWORD);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFullItemName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = *pulEventType;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = ulReserved;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[188]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            *pulEventType = *(ULONG *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaEventCallback_ImageEventCallback_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[594], (void *)pulEventType );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaEventCallback_ImageEventCallback_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaEventCallback * _This;
    HRESULT _RetVal;
    const GUID * pEventGUID;
    BSTR bstrEventDescription;
    void *_p_bstrEventDescription;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    BSTR bstrDeviceDescription;
    void *_p_bstrDeviceDescription;
    DWORD dwDeviceType;
    BSTR bstrFullItemName;
    void *_p_bstrFullItemName;
    ULONG * pulEventType;
    ULONG ulReserved;
};

static void __finally_IWiaEventCallback_ImageEventCallback_Stub( struct __frame_IWiaEventCallback_ImageEventCallback_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrEventDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574]);


    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrFullItemName,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584]);



}

void __RPC_STUB IWiaEventCallback_ImageEventCallback_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaEventCallback_ImageEventCallback_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaEventCallback*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaEventCallback_ImageEventCallback_Stub );
    __frame->pEventGUID = 0;
    MIDL_memset(&__frame->bstrEventDescription, 0, sizeof(__frame->bstrEventDescription));
    __frame->_p_bstrEventDescription = &__frame->bstrEventDescription;
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    MIDL_memset(&__frame->bstrDeviceDescription, 0, sizeof(__frame->bstrDeviceDescription));
    __frame->_p_bstrDeviceDescription = &__frame->bstrDeviceDescription;
    MIDL_memset(&__frame->bstrFullItemName, 0, sizeof(__frame->bstrFullItemName));
    __frame->_p_bstrFullItemName = &__frame->bstrFullItemName;
    __frame->pulEventType = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[188]);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[538],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrEventDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(DWORD) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->dwDeviceType = *(DWORD *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(DWORD);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrFullItemName,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->pulEventType = (ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->ulReserved = *(ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->ImageEventCallback(__frame->_This, __frame->pEventGUID, __frame->bstrEventDescription, __frame->bstrDeviceID, __frame->bstrDeviceDescription, __frame->dwDeviceType, __frame->bstrFullItemName, __frame->pulEventType, __frame->ulReserved);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 16;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(ULONG *)__frame->_StubMsg.Buffer = *__frame->pulEventType;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaEventCallback_ImageEventCallback_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static const unsigned short IWiaEventCallback_FormatStringOffsetTable[] =
{
    188,  /* IWiaEventCallback::ImageEventCallback */
};

static const CINTERFACE_PROXY_VTABLE(4) _IWiaEventCallbackProxyVtbl =
{
    {
        &IID_IWiaEventCallback,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
        IWiaEventCallback_ImageEventCallback_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaEventCallback_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaEventCallback_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaEventCallback_table[] =
{
    IWiaEventCallback_ImageEventCallback_Stub
};

static const CInterfaceStubVtbl _IWiaEventCallbackStubVtbl =
{
    {
        &IID_IWiaEventCallback,
        &IWiaEventCallback_ServerInfo,
        4,
        &IWiaEventCallback_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

static const USER_MARSHAL_ROUTINE_QUADRUPLE UserMarshalRoutines[] =
{
    {
        (USER_MARSHAL_SIZING_ROUTINE)BSTR_UserSize,
        (USER_MARSHAL_MARSHALLING_ROUTINE)BSTR_UserMarshal,
        (USER_MARSHAL_UNMARSHALLING_ROUTINE)BSTR_UserUnmarshal,
        (USER_MARSHAL_FREEING_ROUTINE)BSTR_UserFree
    },
    {
        (USER_MARSHAL_SIZING_ROUTINE)HWND_UserSize,
        (USER_MARSHAL_MARSHALLING_ROUTINE)HWND_UserMarshal,
        (USER_MARSHAL_UNMARSHALLING_ROUTINE)HWND_UserUnmarshal,
        (USER_MARSHAL_FREEING_ROUTINE)HWND_UserFree
    }
};

static const MIDL_STUB_DESC Object_StubDesc =
{
    0,
    NdrOleAllocate,
    NdrOleFree,
    {0}, 0, 0, 0, 0,
    __MIDL_TypeFormatString.Format,
    1, /* -error bounds_check flag */
    0x10001, /* Ndr library version */
    0,
    0x50100a4, /* MIDL Version 5.1.164 */
    0,
    UserMarshalRoutines,
    0,  /* notify & notify_flag routine table */
    1,  /* Flags */
    0,  /* Reserved3 */
    0,  /* Reserved4 */
    0   /* Reserved5 */
};

#if !defined(__RPC_WIN32__)
#error Currently only Wine and WIN32 are supported.
#endif

static const MIDL_PROC_FORMAT_STRING __MIDL_ProcFormatString =
{
    0,
    {
/* 0 (parameter lFlag) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 2 (parameter ppIEnum) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x14),	/* type offset = 20 */
/* 6 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 8 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x30),	/* type offset = 48 */
/* 12 (parameter ppWiaItemRoot) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x4c),	/* type offset = 76 */
/* 16 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 18 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x68),	/* type offset = 104 */
/* 22 (parameter lDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 24 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 26 (parameter pbstrDeviceID) */
        0x50,    /* FC_IN_OUT_PARAM */
        0x01,
        NdrFcShort(0x7c),	/* type offset = 124 */
/* 30 (parameter ppItemRoot) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x92),	/* type offset = 146 */
/* 34 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 36 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x96),	/* type offset = 150 */
/* 40 (parameter lDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 42 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 44 (parameter pbstrDeviceID) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0xa0),	/* type offset = 160 */
/* 48 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 50 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xa4),	/* type offset = 164 */
/* 54 (parameter lDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 56 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 58 (parameter lIntent) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 60 (parameter pItemRoot) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xae),	/* type offset = 174 */
/* 64 (parameter bstrFilename) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xc0),	/* type offset = 192 */
/* 68 (parameter pguidFormat) */
        0x50,    /* FC_IN_OUT_PARAM */
        0x01,
        NdrFcShort(0xdc),	/* type offset = 220 */
/* 72 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 74 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 76 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xe0),	/* type offset = 224 */
/* 80 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xfc),	/* type offset = 252 */
/* 84 (parameter bstrCommandline) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x100),	/* type offset = 256 */
/* 88 (parameter bstrName) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x10a),	/* type offset = 266 */
/* 92 (parameter bstrDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x114),	/* type offset = 276 */
/* 96 (parameter bstrIcon) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x11e),	/* type offset = 286 */
/* 100 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 102 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 104 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x128),	/* type offset = 296 */
/* 108 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x144),	/* type offset = 324 */
/* 112 (parameter pIWiaEventCallback) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x148),	/* type offset = 328 */
/* 116 (parameter pEventObject) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x16c),	/* type offset = 364 */
/* 120 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 122 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 124 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x170),	/* type offset = 368 */
/* 128 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x18c),	/* type offset = 396 */
/* 132 (parameter pClsID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1a2),	/* type offset = 418 */
/* 136 (parameter bstrName) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1a6),	/* type offset = 422 */
/* 140 (parameter bstrDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1b0),	/* type offset = 432 */
/* 144 (parameter bstrIcon) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1ba),	/* type offset = 442 */
/* 148 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 150 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1c4),	/* type offset = 452 */
/* 154 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 156 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 158 (parameter celt) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 160 (parameter rgelt) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x1e0),	/* type offset = 480 */
/* 164 (parameter pceltFetched) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x1f6),	/* type offset = 502 */
/* 168 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 170 (parameter celt) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 172 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 174 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 176 (parameter ppIEnum) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x20c),	/* type offset = 524 */
/* 180 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 182 (parameter celt) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x210),	/* type offset = 528 */
/* 186 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 188 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x226),	/* type offset = 550 */
/* 192 (parameter bstrEventDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x22a),	/* type offset = 554 */
/* 196 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x234),	/* type offset = 564 */
/* 200 (parameter bstrDeviceDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x23e),	/* type offset = 574 */
/* 204 (parameter dwDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 206 (parameter bstrFullItemName) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x248),	/* type offset = 584 */
/* 210 (parameter pulEventType) */
        0x50,    /* FC_IN_OUT_PARAM */
        0x01,
        NdrFcShort(0x252),	/* type offset = 594 */
/* 214 (parameter ulReserved) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 216 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
        0x0
    }
};

static const MIDL_TYPE_FORMAT_STRING __MIDL_TypeFormatString =
{
    0,
    {
        NdrFcShort(0x0),
/* 2 (IEnumWIA_DEV_INFO *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x5e38b83c),
        NdrFcShort(0x8cf1),
        NdrFcShort(0x11d1),
        0xbf,
        0x92,
        0x00,
        0x60,
        0x08,
        0x1e,
        0xd8,
        0x11,

/* 20 (IEnumWIA_DEV_INFO **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (2) */
/* 24 (unsigned short[]) */
        0x1b,	/* FC_CARRAY */
        0x1,	/* 1 */
        NdrFcShort(0x2),	/* 2 */
        0x9,	/* Corr desc: field clSize, FC_ULONG */
        0x0,	/* no operators */
        NdrFcShort(0xfffc),	/* offset = -4 */
        0x06,	/* FC_SHORT */
        0x5b,	/* FC_END */
/* 34 (FLAGGED_WORD_BLOB) */
        0x17,	/* FC_CSTRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0xfff2),	/* Offset= -14 (24) */
        0x08,	/* FC_LONG */
        0x08,	/* FC_LONG */
        0x5c,	/* FC_PAD */
        0x5b,	/* FC_END */
/* 44 (wireBSTR) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xfff4),	/* Offset= -12 (34) */
/* 48 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfff4),	/* Offset= -12 (44) */
/* 58 (IWiaItem *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x4db1ad10),
        NdrFcShort(0x3391),
        NdrFcShort(0x11d2),
        0x9a,
        0x33,
        0x00,
        0xc0,
        0x4f,
        0xa3,
        0x61,
        0x45,

/* 76 (IWiaItem **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (58) */
/* 80 (RemotableHandle) */
        0x2a,	/* FC_ENCAPSULATED_UNION */
        0x48,	/* Switch type= FC_LONG */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x2),	/* 2 */
        NdrFcLong(0x48746457),	/* 1215587415 */
        NdrFcShort(0x8008),	/* Simple arm type: FC_LONG */
        NdrFcLong(0x52746457),	/* 1383359575 */
        NdrFcShort(0x8008),	/* Simple arm type: FC_LONG */
        NdrFcShort(0xffff),
/* 100 (wireHWND) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xffea),	/* Offset= -22 (80) */
/* 104 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfff4),	/* Offset= -12 (100) */
/* 114 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xffb2),	/* Offset= -78 (44) */
/* 124 (BSTR *) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xfff4),	/* Offset= -12 (114) */
/* 128 (IWiaItem *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x4db1ad10),
        NdrFcShort(0x3391),
        NdrFcShort(0x11d2),
        0x9a,
        0x33,
        0x00,
        0xc0,
        0x4f,
        0xa3,
        0x61,
        0x45,

/* 146 (IWiaItem **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (128) */
/* 150 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xffc6),	/* Offset= -58 (100) */
/* 160 (BSTR *) */
        0x11, 0x4,		/* FC_RP [allocated_on_stack] */
        NdrFcShort(0xffd0),	/* Offset= -48 (114) */
/* 164 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xffb8),	/* Offset= -72 (100) */
/* 174 (IWiaItem *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x4db1ad10),
        NdrFcShort(0x3391),
        NdrFcShort(0x11d2),
        0x9a,
        0x33,
        0x00,
        0xc0,
        0x4f,
        0xa3,
        0x61,
        0x45,

/* 192 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff64),	/* Offset= -156 (44) */
/* 202 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 208 (GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (202) */
        0x5b,	/* FC_END */
/* 220 (GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (208) */
/* 224 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff44),	/* Offset= -188 (44) */
/* 234 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 240 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (234) */
        0x5b,	/* FC_END */
/* 252 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (240) */
/* 256 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff24),	/* Offset= -220 (44) */
/* 266 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff1a),	/* Offset= -230 (44) */
/* 276 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff10),	/* Offset= -240 (44) */
/* 286 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff06),	/* Offset= -250 (44) */
/* 296 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfefc),	/* Offset= -260 (44) */
/* 306 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 312 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (306) */
        0x5b,	/* FC_END */
/* 324 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (312) */
/* 328 (IWiaEventCallback *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0xae6287b0),
        NdrFcShort(0x0084),
        NdrFcShort(0x11d2),
        0x97,
        0x3b,
        0x00,
        0xa0,
        0xc9,
        0x06,
        0x8f,
        0x2e,

/* 346 (IUnknown *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x00000000),
        NdrFcShort(0x0000),
        NdrFcShort(0x0000),
        0xc0,
        0x00,
        0x00,
        0x00,
        0x00,
        0x00,
        0x00,
        0x46,

/* 364 (IUnknown **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (346) */
/* 368 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfeb4),	/* Offset= -332 (44) */
/* 378 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 384 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (378) */
        0x5b,	/* FC_END */
/* 396 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (384) */
/* 400 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 406 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (400) */
        0x5b,	/* FC_END */
/* 418 (const GUID *) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xfff2),	/* Offset= -14 (406) */
/* 422 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe7e),	/* Offset= -386 (44) */
/* 432 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe74),	/* Offset= -396 (44) */
/* 442 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe6a),	/* Offset= -406 (44) */
/* 452 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe98),	/* Offset= -360 (100) */
/* 462 (IWiaPropertyStorage *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x98b5e8a0),
        NdrFcShort(0x29cc),
        NdrFcShort(0x491a),
        0xaa,
        0xc0,
        0xe6,
        0xdb,
        0x4f,
        0xdc,
        0xce,
        0xb6,

/* 480 (IWiaPropertyStorage **) */
        0x21,	/* FC_BOGUS_ARRAY */
        0x3,	/* 3 */
        NdrFcShort(0x0),	/* 0 */
        0x29,	/* Corr desc: parameter celt, FC_ULONG */
        0x0,	/* no operators */
        NdrFcShort(0x4),	/* offset = 4 */
        0x29,	/* Corr desc: parameter pceltFetched, FC_ULONG */
        0x54,	/* FC_DEREFERENCE */
        NdrFcShort(0xc),	/* offset = 12 */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xffe0),	/* Offset= -32 (462) */
        0x5c,	/* FC_PAD */
        0x5b,	/* FC_END */
/* 498 */
        0x11, 0x0,	/* FC_RP */
        NdrFcShort(0xffec),	/* Offset= -20 (480) */
/* 502 (ULONG *) */
        0x11, 0xc,	/* FC_RP [allocated_on_stack] [simple_pointer] */
        0x09,	/* FC_ULONG */
        0x5c,	/* FC_PAD */
/* 506 (IEnumWIA_DEV_INFO *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x5e38b83c),
        NdrFcShort(0x8cf1),
        NdrFcShort(0x11d1),
        0xbf,
        0x92,
        0x00,
        0x60,
        0x08,
        0x1e,
        0xd8,
        0x11,

/* 524 (IEnumWIA_DEV_INFO **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (506) */
/* 528 (ULONG *) */
        0x11, 0xc,	/* FC_RP [allocated_on_stack] [simple_pointer] */
        0x09,	/* FC_ULONG */
        0x5c,	/* FC_PAD */
/* 532 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 538 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (532) */
        0x5b,	/* FC_END */
/* 550 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (538) */
/* 554 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfdfa),	/* Offset= -518 (44) */
/* 564 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfdf0),	/* Offset= -528 (44) */
/* 574 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfde6),	/* Offset= -538 (44) */
/* 584 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfddc),	/* Offset= -548 (44) */
/* 594 (ULONG *) */
        0x11, 0x8,	/* FC_RP [simple_pointer] */
        0x09,	/* FC_ULONG */
        0x5c,	/* FC_PAD */
        0x0
    }
};

static const CInterfaceProxyVtbl* const _sti_wia_ProxyVtblList[] =
{
    (const CInterfaceProxyVtbl*)&_IWiaItemProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IWiaDevMgrProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IEnumWIA_DEV_INFOProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IWiaPropertyStorageProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IWiaEventCallbackProxyVtbl,
    0
};

static const CInterfaceStubVtbl* const _sti_wia_StubVtblList[] =
{
    &_IWiaItemStubVtbl,
    &_IWiaDevMgrStubVtbl,
    &_IEnumWIA_DEV_INFOStubVtbl,
    &_IWiaPropertyStorageStubVtbl,
    &_IWiaEventCallbackStubVtbl,
    0
};

static PCInterfaceName const _sti_wia_InterfaceNamesList[] =
{
    "IWiaItem",
    "IWiaDevMgr",
    "IEnumWIA_DEV_INFO",
    "IWiaPropertyStorage",
    "IWiaEventCallback",
    0
};

static int __stdcall _sti_wia_IID_Lookup(const IID* pIID, int* pIndex)
{
    int low = 0, high = 4;

    while (low <= high)
    {
        int pos = (low + high) / 2;
        int res = IID_GENERIC_CHECK_IID(_sti_wia, pIID, pos);
        if (!res) { *pIndex = pos; return 1; }
        if (res > 0) low = pos + 1;
        else high = pos - 1;
    }
    return 0;
}

const ExtendedProxyFileInfo sti_wia_ProxyFileInfo DECLSPEC_HIDDEN =
{
    (const PCInterfaceProxyVtblList*)_sti_wia_ProxyVtblList,
    (const PCInterfaceStubVtblList*)_sti_wia_StubVtblList,
    _sti_wia_InterfaceNamesList,
    0,
    _sti_wia_IID_Lookup,
    5,
    1,
    0,
    0,
    0,
    0
};

#else /* _WIN64 */

#ifndef __REDQ_RPCPROXY_H_VERSION__
#define __REQUIRED_RPCPROXY_H_VERSION__ 440
#endif

#include "rpcproxy.h"
#ifndef __RPCPROXY_H_VERSION__
#error This code needs a newer version of rpcproxy.h
#endif /* __RPCPROXY_H_VERSION__ */

#include "sti_wia.h"

#ifndef USE_COMPILER_EXCEPTIONS

#include "wine/exception.h"
#undef RpcTryExcept
#undef RpcExcept
#undef RpcEndExcept
#undef RpcTryFinally
#undef RpcFinally
#undef RpcEndFinally
#undef RpcExceptionCode
#undef RpcAbnormalTermination

struct __exception_frame;
typedef int (*__filter_func)(struct __exception_frame *);
typedef void (*__finally_func)(struct __exception_frame *);

#define __DECL_EXCEPTION_FRAME \
    EXCEPTION_REGISTRATION_RECORD frame; \
    __filter_func                 filter; \
    __finally_func                finally; \
    sigjmp_buf                    jmp; \
    DWORD                         code; \
    unsigned char                 abnormal_termination; \
    unsigned char                 filter_level; \
    unsigned char                 finally_level;

struct __exception_frame
{
    __DECL_EXCEPTION_FRAME
};

static inline void __widl_unwind_target(void)
{
    struct __exception_frame *exc_frame = (struct __exception_frame *)__wine_get_frame();
    if (exc_frame->finally_level > exc_frame->filter_level)
    {
        exc_frame->abnormal_termination = 1;
        exc_frame->finally( exc_frame );
        __wine_pop_frame( &exc_frame->frame );
    }
    exc_frame->filter_level = 0;
    siglongjmp( exc_frame->jmp, 1 );
}

static DWORD __widl_exception_handler( EXCEPTION_RECORD *record,
                                       EXCEPTION_REGISTRATION_RECORD *frame,
                                       CONTEXT *context,
                                       EXCEPTION_REGISTRATION_RECORD **pdispatcher )
{
    struct __exception_frame *exc_frame = (struct __exception_frame *)frame;

    if (record->ExceptionFlags & (EH_UNWINDING | EH_EXIT_UNWIND | EH_NESTED_CALL))
    {
        if (exc_frame->finally_level && (record->ExceptionFlags & (EH_UNWINDING | EH_EXIT_UNWIND)))
        {
            exc_frame->abnormal_termination = 1;
            exc_frame->finally( exc_frame );
        }
        return ExceptionContinueSearch;
    }
    exc_frame->code = record->ExceptionCode;
    if (exc_frame->filter_level && exc_frame->filter( exc_frame ) == EXCEPTION_EXECUTE_HANDLER)
        __wine_rtl_unwind( frame, record, __widl_unwind_target );
    return ExceptionContinueSearch;
}

#define RpcTryExcept \
    if (!sigsetjmp( __frame->jmp, 0 )) \
    { \
        if (!__frame->finally_level) \
            __wine_push_frame( &__frame->frame ); \
        __frame->filter_level = __frame->finally_level + 1;

#define RpcExcept(expr) \
        if (!__frame->finally_level) \
            __wine_pop_frame( &__frame->frame ); \
        __frame->filter_level = 0; \
    } \
    else \

#define RpcEndExcept

#define RpcExceptionCode() (__frame->code)

#define RpcTryFinally \
    if (!__frame->filter_level) \
        __wine_push_frame( &__frame->frame ); \
    __frame->finally_level = __frame->filter_level + 1;

#define RpcFinally \
    if (!__frame->filter_level) \
        __wine_pop_frame( &__frame->frame ); \
    __frame->finally_level = 0;

#define RpcEndFinally

#define RpcAbnormalTermination() (__frame->abnormal_termination)

#define RpcExceptionInit(filter_func,finally_func) \
    do { \
        __frame->frame.Handler = __widl_exception_handler; \
        __frame->filter = (__filter_func)(filter_func); \
        __frame->finally = (__finally_func)(finally_func); \
        __frame->abnormal_termination = 0; \
        __frame->filter_level = 0; \
        __frame->finally_level = 0; \
    } while (0)

#else /* USE_COMPILER_EXCEPTIONS */

#define RpcExceptionInit(filter_func,finally_func) \
    do { (void)(filter_func); } while(0)

#define __DECL_EXCEPTION_FRAME \
    DWORD code;

#endif /* USE_COMPILER_EXCEPTIONS */

struct __proxy_frame
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    void             *This;
};

static int __proxy_filter( struct __proxy_frame *__frame )
{
    return (__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE);
}

#define TYPE_FORMAT_STRING_SIZE 599
#define PROC_FORMAT_STRING_SIZE 219

typedef struct _MIDL_TYPE_FORMAT_STRING
{
    short Pad;
    unsigned char Format[TYPE_FORMAT_STRING_SIZE];
} MIDL_TYPE_FORMAT_STRING;

typedef struct _MIDL_PROC_FORMAT_STRING
{
    short Pad;
    unsigned char Format[PROC_FORMAT_STRING_SIZE];
} MIDL_PROC_FORMAT_STRING;


static const MIDL_TYPE_FORMAT_STRING __MIDL_TypeFormatString;
static const MIDL_PROC_FORMAT_STRING __MIDL_ProcFormatString;

static const MIDL_STUB_DESC Object_StubDesc;

/*****************************************************************************
 * IWiaDevMgr interface
 */
static void __finally_IWiaDevMgr_EnumDeviceInfo_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_EnumDeviceInfo_Proxy(
    IWiaDevMgr* This,
    LONG lFlag,
    IEnumWIA_DEV_INFO **ppIEnum)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_EnumDeviceInfo_Proxy );
    __frame->This = This;
    if (ppIEnum) MIDL_memset( ppIEnum, 0, sizeof( *ppIEnum ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 3);
        if (!ppIEnum) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlag;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[0]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppIEnum,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_EnumDeviceInfo_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[20], (void *)ppIEnum );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_EnumDeviceInfo_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlag;
    IEnumWIA_DEV_INFO *_W0;
    IEnumWIA_DEV_INFO ** ppIEnum;
};

static void __finally_IWiaDevMgr_EnumDeviceInfo_Stub( struct __frame_IWiaDevMgr_EnumDeviceInfo_Stub *__frame )
{

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppIEnum,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20]);

}

void __RPC_STUB IWiaDevMgr_EnumDeviceInfo_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_EnumDeviceInfo_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_EnumDeviceInfo_Stub );
    __frame->ppIEnum = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[0]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlag = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);


        __frame->ppIEnum = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->EnumDeviceInfo(__frame->_This, __frame->lFlag, __frame->ppIEnum);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[20]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_EnumDeviceInfo_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_CreateDevice_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_CreateDevice_Proxy(
    IWiaDevMgr* This,
    BSTR bstrDeviceID,
    IWiaItem **ppWiaItemRoot)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_CreateDevice_Proxy );
    __frame->This = This;
    if (ppWiaItemRoot) MIDL_memset( ppWiaItemRoot, 0, sizeof( *ppWiaItemRoot ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 4);
        if (!ppWiaItemRoot) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[8]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppWiaItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_CreateDevice_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[76], (void *)ppWiaItemRoot );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_CreateDevice_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    IWiaItem *_W0;
    IWiaItem ** ppWiaItemRoot;
};

static void __finally_IWiaDevMgr_CreateDevice_Stub( struct __frame_IWiaDevMgr_CreateDevice_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48]);

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppWiaItemRoot,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76]);

}

void __RPC_STUB IWiaDevMgr_CreateDevice_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_CreateDevice_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_CreateDevice_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->ppWiaItemRoot = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[8]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[48],
            0);


        __frame->ppWiaItemRoot = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->CreateDevice(__frame->_This, __frame->bstrDeviceID, __frame->ppWiaItemRoot);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppWiaItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppWiaItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[76]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_CreateDevice_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_SelectDeviceDlg_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_SelectDeviceDlg_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lDeviceType,
    LONG lFlags,
    BSTR *pbstrDeviceID,
    IWiaItem **ppItemRoot)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_SelectDeviceDlg_Proxy );
    __frame->This = This;
    if (ppItemRoot) MIDL_memset( ppItemRoot, 0, sizeof( *ppItemRoot ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 5);
        if (!ppItemRoot) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 16;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104]);

            NdrPointerBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lDeviceType;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrPointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[18]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124],
                0);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_SelectDeviceDlg_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[124], (void *)pbstrDeviceID );

        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[146], (void *)ppItemRoot );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_SelectDeviceDlg_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lDeviceType;
    LONG lFlags;
    BSTR * pbstrDeviceID;
    IWiaItem *_W0;
    IWiaItem ** ppItemRoot;
};

static void __finally_IWiaDevMgr_SelectDeviceDlg_Stub( struct __frame_IWiaDevMgr_SelectDeviceDlg_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104]);



    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pbstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppItemRoot,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146]);

}

void __RPC_STUB IWiaDevMgr_SelectDeviceDlg_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_SelectDeviceDlg_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_SelectDeviceDlg_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;
    __frame->pbstrDeviceID = 0;
    __frame->ppItemRoot = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[18]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[104],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lDeviceType = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrPointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124],
            0);


        __frame->ppItemRoot = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->SelectDeviceDlg(__frame->_This, __frame->hwndParent, __frame->lDeviceType, __frame->lFlags, __frame->pbstrDeviceID, __frame->ppItemRoot);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[124]);

        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[146]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_SelectDeviceDlg_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_SelectDeviceDlgID_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_SelectDeviceDlgID_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lDeviceType,
    LONG lFlags,
    BSTR *pbstrDeviceID)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_SelectDeviceDlgID_Proxy );
    __frame->This = This;
    if (pbstrDeviceID) MIDL_memset( pbstrDeviceID, 0, sizeof( *pbstrDeviceID ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 6);
        if (!pbstrDeviceID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 16;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lDeviceType;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[36]);

            NdrUserMarshalUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pbstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[114],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_SelectDeviceDlgID_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[160], (void *)pbstrDeviceID );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_SelectDeviceDlgID_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lDeviceType;
    LONG lFlags;
    BSTR _W0;
    BSTR * pbstrDeviceID;
};

static void __finally_IWiaDevMgr_SelectDeviceDlgID_Stub( struct __frame_IWiaDevMgr_SelectDeviceDlgID_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150]);



    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pbstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[160]);

}

void __RPC_STUB IWiaDevMgr_SelectDeviceDlgID_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_SelectDeviceDlgID_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_SelectDeviceDlgID_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;
    __frame->pbstrDeviceID = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[36]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[150],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lDeviceType = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);


        __frame->pbstrDeviceID = &__frame->_W0;
        memset(&__frame->_W0, 0, sizeof(__frame->_W0));

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->SelectDeviceDlgID(__frame->_This, __frame->hwndParent, __frame->lDeviceType, __frame->lFlags, __frame->pbstrDeviceID);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrUserMarshalBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[114]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrUserMarshalMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pbstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[114]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_SelectDeviceDlgID_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_GetImageDlg_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_GetImageDlg_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lDeviceType,
    LONG lFlags,
    LONG lIntent,
    IWiaItem *pItemRoot,
    BSTR bstrFilename,
    GUID *pguidFormat)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_GetImageDlg_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 7);
        if (!pguidFormat) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 44;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164]);

            NdrInterfacePointerBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)pItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFilename,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lDeviceType;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lIntent;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrInterfacePointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pItemRoot,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFilename,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pguidFormat,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[50]);

            NdrSimpleStructUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pguidFormat,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_GetImageDlg_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[220], (void *)pguidFormat );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_GetImageDlg_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lDeviceType;
    LONG lFlags;
    LONG lIntent;
    IWiaItem * pItemRoot;
    BSTR bstrFilename;
    void *_p_bstrFilename;
    GUID * pguidFormat;
};

static void __finally_IWiaDevMgr_GetImageDlg_Stub( struct __frame_IWiaDevMgr_GetImageDlg_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164]);




    NdrInterfacePointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pItemRoot,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrFilename,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192]);


}

void __RPC_STUB IWiaDevMgr_GetImageDlg_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_GetImageDlg_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_GetImageDlg_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;
    __frame->pItemRoot = 0;
    MIDL_memset(&__frame->bstrFilename, 0, sizeof(__frame->bstrFilename));
    __frame->_p_bstrFilename = &__frame->bstrFilename;
    __frame->pguidFormat = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[50]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[164],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lDeviceType = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lIntent = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrInterfacePointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pItemRoot,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[174],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrFilename,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[192],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pguidFormat,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208],
            0);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->GetImageDlg(__frame->_This, __frame->hwndParent, __frame->lDeviceType, __frame->lFlags, __frame->lIntent, __frame->pItemRoot, __frame->bstrFilename, __frame->pguidFormat);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 28;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrSimpleStructMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pguidFormat,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[208]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_GetImageDlg_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_RegisterEventCallbackProgram_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_RegisterEventCallbackProgram_Proxy(
    IWiaDevMgr* This,
    LONG lFlags,
    BSTR bstrDeviceID,
    const GUID *pEventGUID,
    BSTR bstrCommandline,
    BSTR bstrName,
    BSTR bstrDescription,
    BSTR bstrIcon)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_RegisterEventCallbackProgram_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 8);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 28;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrCommandline,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[240]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrCommandline,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[74]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_RegisterEventCallbackProgram_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_RegisterEventCallbackProgram_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlags;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    const GUID * pEventGUID;
    BSTR bstrCommandline;
    void *_p_bstrCommandline;
    BSTR bstrName;
    void *_p_bstrName;
    BSTR bstrDescription;
    void *_p_bstrDescription;
    BSTR bstrIcon;
    void *_p_bstrIcon;
};

static void __finally_IWiaDevMgr_RegisterEventCallbackProgram_Stub( struct __frame_IWiaDevMgr_RegisterEventCallbackProgram_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224]);


    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrCommandline,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrName,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrIcon,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286]);

}

void __RPC_STUB IWiaDevMgr_RegisterEventCallbackProgram_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_RegisterEventCallbackProgram_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_RegisterEventCallbackProgram_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->pEventGUID = 0;
    MIDL_memset(&__frame->bstrCommandline, 0, sizeof(__frame->bstrCommandline));
    __frame->_p_bstrCommandline = &__frame->bstrCommandline;
    MIDL_memset(&__frame->bstrName, 0, sizeof(__frame->bstrName));
    __frame->_p_bstrName = &__frame->bstrName;
    MIDL_memset(&__frame->bstrDescription, 0, sizeof(__frame->bstrDescription));
    __frame->_p_bstrDescription = &__frame->bstrDescription;
    MIDL_memset(&__frame->bstrIcon, 0, sizeof(__frame->bstrIcon));
    __frame->_p_bstrIcon = &__frame->bstrIcon;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[74]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[224],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[240],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrCommandline,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[256],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrName,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[266],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[276],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrIcon,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[286],
            0);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->RegisterEventCallbackProgram(__frame->_This, __frame->lFlags, __frame->bstrDeviceID, __frame->pEventGUID, __frame->bstrCommandline, __frame->bstrName, __frame->bstrDescription, __frame->bstrIcon);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_RegisterEventCallbackProgram_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_RegisterEventCallbackInterface_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_RegisterEventCallbackInterface_Proxy(
    IWiaDevMgr* This,
    LONG lFlags,
    BSTR bstrDeviceID,
    const GUID *pEventGUID,
    IWiaEventCallback *pIWiaEventCallback,
    IUnknown **pEventObject)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_RegisterEventCallbackInterface_Proxy );
    __frame->This = This;
    if (pEventObject) MIDL_memset( pEventObject, 0, sizeof( *pEventObject ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 9);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        if (!pEventObject) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 28;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296]);

            NdrInterfacePointerBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)pIWiaEventCallback,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[312]);

            NdrInterfacePointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pIWiaEventCallback,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[102]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&pEventObject,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_RegisterEventCallbackInterface_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[364], (void *)pEventObject );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_RegisterEventCallbackInterface_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlags;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    const GUID * pEventGUID;
    IWiaEventCallback * pIWiaEventCallback;
    IUnknown *_W0;
    IUnknown ** pEventObject;
};

static void __finally_IWiaDevMgr_RegisterEventCallbackInterface_Stub( struct __frame_IWiaDevMgr_RegisterEventCallbackInterface_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296]);


    NdrInterfacePointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pIWiaEventCallback,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328]);

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pEventObject,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364]);

}

void __RPC_STUB IWiaDevMgr_RegisterEventCallbackInterface_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_RegisterEventCallbackInterface_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_RegisterEventCallbackInterface_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->pEventGUID = 0;
    __frame->pIWiaEventCallback = 0;
    __frame->pEventObject = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[102]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[296],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[312],
            0);

        NdrInterfacePointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pIWiaEventCallback,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[328],
            0);


        __frame->pEventObject = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->RegisterEventCallbackInterface(__frame->_This, __frame->lFlags, __frame->bstrDeviceID, __frame->pEventGUID, __frame->pIWiaEventCallback, __frame->pEventObject);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pEventObject,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->pEventObject,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[364]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_RegisterEventCallbackInterface_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_RegisterEventCallbackCLSID_Proxy(
    IWiaDevMgr* This,
    LONG lFlags,
    BSTR bstrDeviceID,
    const GUID *pEventGUID,
    const GUID *pClsID,
    BSTR bstrName,
    BSTR bstrDescription,
    BSTR bstrIcon)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 10);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 56;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368]);

            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[384]);

            NdrPointerMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pClsID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[418]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrIcon,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442]);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[122]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_RegisterEventCallbackCLSID_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    LONG lFlags;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    const GUID * pEventGUID;
    const GUID * pClsID;
    BSTR bstrName;
    void *_p_bstrName;
    BSTR bstrDescription;
    void *_p_bstrDescription;
    BSTR bstrIcon;
    void *_p_bstrIcon;
};

static void __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Stub( struct __frame_IWiaDevMgr_RegisterEventCallbackCLSID_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368]);


    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->pClsID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[418]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrName,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrIcon,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442]);

}

void __RPC_STUB IWiaDevMgr_RegisterEventCallbackCLSID_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_RegisterEventCallbackCLSID_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Stub );
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    __frame->pEventGUID = 0;
    __frame->pClsID = 0;
    MIDL_memset(&__frame->bstrName, 0, sizeof(__frame->bstrName));
    __frame->_p_bstrName = &__frame->bstrName;
    MIDL_memset(&__frame->bstrDescription, 0, sizeof(__frame->bstrDescription));
    __frame->_p_bstrDescription = &__frame->bstrDescription;
    MIDL_memset(&__frame->bstrIcon, 0, sizeof(__frame->bstrIcon));
    __frame->_p_bstrIcon = &__frame->bstrIcon;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[122]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[368],
            0);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[384],
            0);

        NdrPointerUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pClsID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[418],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrName,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[422],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[432],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrIcon,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[442],
            0);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->RegisterEventCallbackCLSID(__frame->_This, __frame->lFlags, __frame->bstrDeviceID, __frame->pEventGUID, __frame->pClsID, __frame->bstrName, __frame->bstrDescription, __frame->bstrIcon);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_RegisterEventCallbackCLSID_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IWiaDevMgr_AddDeviceDlg_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaDevMgr_AddDeviceDlg_Proxy(
    IWiaDevMgr* This,
    HWND hwndParent,
    LONG lFlags)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaDevMgr_AddDeviceDlg_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 11);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&hwndParent,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(LONG *)__frame->_StubMsg.Buffer = lFlags;
            __frame->_StubMsg.Buffer += sizeof(LONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[150]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaDevMgr_AddDeviceDlg_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaDevMgr_AddDeviceDlg_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaDevMgr * _This;
    HRESULT _RetVal;
    HWND hwndParent;
    void *_p_hwndParent;
    LONG lFlags;
};

static void __finally_IWiaDevMgr_AddDeviceDlg_Stub( struct __frame_IWiaDevMgr_AddDeviceDlg_Stub *__frame )
{
    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->hwndParent,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452]);


}

void __RPC_STUB IWiaDevMgr_AddDeviceDlg_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaDevMgr_AddDeviceDlg_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaDevMgr*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaDevMgr_AddDeviceDlg_Stub );
    MIDL_memset(&__frame->hwndParent, 0, sizeof(__frame->hwndParent));
    __frame->_p_hwndParent = &__frame->hwndParent;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[150]);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_hwndParent,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[452],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(LONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->lFlags = *(LONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(LONG);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->AddDeviceDlg(__frame->_This, __frame->hwndParent, __frame->lFlags);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaDevMgr_AddDeviceDlg_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static const unsigned short IWiaDevMgr_FormatStringOffsetTable[] =
{
    0,  /* IWiaDevMgr::EnumDeviceInfo */
    8,  /* IWiaDevMgr::CreateDevice */
    18,  /* IWiaDevMgr::SelectDeviceDlg */
    36,  /* IWiaDevMgr::SelectDeviceDlgID */
    50,  /* IWiaDevMgr::GetImageDlg */
    74,  /* IWiaDevMgr::RegisterEventCallbackProgram */
    102,  /* IWiaDevMgr::RegisterEventCallbackInterface */
    122,  /* IWiaDevMgr::RegisterEventCallbackCLSID */
    150,  /* IWiaDevMgr::AddDeviceDlg */
};

static const CINTERFACE_PROXY_VTABLE(12) _IWiaDevMgrProxyVtbl =
{
    {
        &IID_IWiaDevMgr,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
        IWiaDevMgr_EnumDeviceInfo_Proxy,
        IWiaDevMgr_CreateDevice_Proxy,
        IWiaDevMgr_SelectDeviceDlg_Proxy,
        IWiaDevMgr_SelectDeviceDlgID_Proxy,
        IWiaDevMgr_GetImageDlg_Proxy,
        IWiaDevMgr_RegisterEventCallbackProgram_Proxy,
        IWiaDevMgr_RegisterEventCallbackInterface_Proxy,
        IWiaDevMgr_RegisterEventCallbackCLSID_Proxy,
        IWiaDevMgr_AddDeviceDlg_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaDevMgr_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaDevMgr_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaDevMgr_table[] =
{
    IWiaDevMgr_EnumDeviceInfo_Stub,
    IWiaDevMgr_CreateDevice_Stub,
    IWiaDevMgr_SelectDeviceDlg_Stub,
    IWiaDevMgr_SelectDeviceDlgID_Stub,
    IWiaDevMgr_GetImageDlg_Stub,
    IWiaDevMgr_RegisterEventCallbackProgram_Stub,
    IWiaDevMgr_RegisterEventCallbackInterface_Stub,
    IWiaDevMgr_RegisterEventCallbackCLSID_Stub,
    IWiaDevMgr_AddDeviceDlg_Stub
};

static const CInterfaceStubVtbl _IWiaDevMgrStubVtbl =
{
    {
        &IID_IWiaDevMgr,
        &IWiaDevMgr_ServerInfo,
        12,
        &IWiaDevMgr_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

/*****************************************************************************
 * IEnumWIA_DEV_INFO interface
 */
static void __finally_IEnumWIA_DEV_INFO_Next_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Next_Proxy(
    IEnumWIA_DEV_INFO* This,
    ULONG celt,
    IWiaPropertyStorage **rgelt,
    ULONG *pceltFetched)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Next_Proxy );
    __frame->This = This;
    if (rgelt) MIDL_memset( rgelt, 0, sizeof( *rgelt ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 3);
        if (!rgelt) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        if (!pceltFetched) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = celt;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[158]);

            NdrComplexArrayUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&rgelt,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[480],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            *pceltFetched = *(ULONG *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Next_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        __frame->_StubMsg.MaxCount = (ULONG_PTR)celt;

        __frame->_StubMsg.Offset = 0;
        __frame->_StubMsg.ActualCount = __frame->_StubMsg.MaxCount;

        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[498], (void *)rgelt );

        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[502], (void *)pceltFetched );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Next_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    ULONG celt;
    IWiaPropertyStorage ** rgelt;
    ULONG _W0;
    ULONG * pceltFetched;
};

static void __finally_IEnumWIA_DEV_INFO_Next_Stub( struct __frame_IEnumWIA_DEV_INFO_Next_Stub *__frame )
{

    __frame->_StubMsg.MaxCount = (ULONG_PTR)__frame->celt;

    __frame->_StubMsg.Offset = 0;
    __frame->_StubMsg.ActualCount = (ULONG_PTR)*__frame->pceltFetched;

    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->rgelt,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[498]);


}

void __RPC_STUB IEnumWIA_DEV_INFO_Next_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Next_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Next_Stub );
    __frame->rgelt = 0;
    __frame->pceltFetched = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[158]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->celt = *(ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        __frame->rgelt = NdrAllocate(&__frame->_StubMsg, __frame->celt * 8);
        memset(__frame->rgelt, 0, __frame->celt * 8);
        __frame->pceltFetched = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Next(__frame->_This, __frame->celt, __frame->rgelt, __frame->pceltFetched);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 16;
        __frame->_StubMsg.MaxCount = (ULONG_PTR)__frame->celt;

        __frame->_StubMsg.Offset = 0;
        __frame->_StubMsg.ActualCount = (ULONG_PTR)*__frame->pceltFetched;

        NdrComplexArrayBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->rgelt,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[480]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        __frame->_StubMsg.MaxCount = (ULONG_PTR)__frame->celt;

        __frame->_StubMsg.Offset = 0;
        __frame->_StubMsg.ActualCount = (ULONG_PTR)*__frame->pceltFetched;

        NdrComplexArrayMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->rgelt,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[480]);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(ULONG *)__frame->_StubMsg.Buffer = *__frame->pceltFetched;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Next_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_Skip_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Skip_Proxy(
    IEnumWIA_DEV_INFO* This,
    ULONG celt)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Skip_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 4);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 8;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = celt;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[170]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Skip_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Skip_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    ULONG celt;
};

static void __finally_IEnumWIA_DEV_INFO_Skip_Stub( struct __frame_IEnumWIA_DEV_INFO_Skip_Stub *__frame )
{

}

void __RPC_STUB IEnumWIA_DEV_INFO_Skip_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Skip_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Skip_Stub );

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[170]);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->celt = *(ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Skip(__frame->_This, __frame->celt);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Skip_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_Reset_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Reset_Proxy(
    IEnumWIA_DEV_INFO* This)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Reset_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 5);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[174]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Reset_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Reset_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
};

static void __finally_IEnumWIA_DEV_INFO_Reset_Stub( struct __frame_IEnumWIA_DEV_INFO_Reset_Stub *__frame )
{
}

void __RPC_STUB IEnumWIA_DEV_INFO_Reset_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Reset_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Reset_Stub );
    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[174]);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Reset(__frame->_This);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);

        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Reset_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_Clone_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_Clone_Proxy(
    IEnumWIA_DEV_INFO* This,
    IEnumWIA_DEV_INFO **ppIEnum)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_Clone_Proxy );
    __frame->This = This;
    if (ppIEnum) MIDL_memset( ppIEnum, 0, sizeof( *ppIEnum ));
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 6);
        if (!ppIEnum) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[176]);

            NdrPointerUnmarshall(
                &__frame->_StubMsg,
                (unsigned char **)&ppIEnum,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524],
                0);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_Clone_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[524], (void *)ppIEnum );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_Clone_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    IEnumWIA_DEV_INFO *_W0;
    IEnumWIA_DEV_INFO ** ppIEnum;
};

static void __finally_IEnumWIA_DEV_INFO_Clone_Stub( struct __frame_IEnumWIA_DEV_INFO_Clone_Stub *__frame )
{
    NdrPointerFree(
        &__frame->_StubMsg,
        (unsigned char *)__frame->ppIEnum,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524]);

}

void __RPC_STUB IEnumWIA_DEV_INFO_Clone_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_Clone_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_Clone_Stub );
    __frame->ppIEnum = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[176]);


        __frame->ppIEnum = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->Clone(__frame->_This, __frame->ppIEnum);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 8;
        NdrPointerBufferSize(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524]);

        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        NdrPointerMarshall(
            &__frame->_StubMsg,
            (unsigned char *)__frame->ppIEnum,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[524]);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_Clone_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static void __finally_IEnumWIA_DEV_INFO_GetCount_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IEnumWIA_DEV_INFO_GetCount_Proxy(
    IEnumWIA_DEV_INFO* This,
    ULONG *celt)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IEnumWIA_DEV_INFO_GetCount_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 7);
        if (!celt) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 0;
            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[182]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            *celt = *(ULONG *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IEnumWIA_DEV_INFO_GetCount_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[528], (void *)celt );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IEnumWIA_DEV_INFO_GetCount_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IEnumWIA_DEV_INFO * _This;
    HRESULT _RetVal;
    ULONG _W0;
    ULONG * celt;
};

static void __finally_IEnumWIA_DEV_INFO_GetCount_Stub( struct __frame_IEnumWIA_DEV_INFO_GetCount_Stub *__frame )
{

}

void __RPC_STUB IEnumWIA_DEV_INFO_GetCount_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IEnumWIA_DEV_INFO_GetCount_Stub __f, * const __frame = &__f;

    __frame->_This = (IEnumWIA_DEV_INFO*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IEnumWIA_DEV_INFO_GetCount_Stub );
    __frame->celt = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[182]);


        __frame->celt = &__frame->_W0;
        __frame->_W0 = 0;

        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->GetCount(__frame->_This, __frame->celt);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 16;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(ULONG *)__frame->_StubMsg.Buffer = *__frame->celt;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IEnumWIA_DEV_INFO_GetCount_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static const unsigned short IEnumWIA_DEV_INFO_FormatStringOffsetTable[] =
{
    158,  /* IEnumWIA_DEV_INFO::Next */
    170,  /* IEnumWIA_DEV_INFO::Skip */
    174,  /* IEnumWIA_DEV_INFO::Reset */
    176,  /* IEnumWIA_DEV_INFO::Clone */
    182,  /* IEnumWIA_DEV_INFO::GetCount */
};

static const CINTERFACE_PROXY_VTABLE(8) _IEnumWIA_DEV_INFOProxyVtbl =
{
    {
        &IID_IEnumWIA_DEV_INFO,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
        IEnumWIA_DEV_INFO_Next_Proxy,
        IEnumWIA_DEV_INFO_Skip_Proxy,
        IEnumWIA_DEV_INFO_Reset_Proxy,
        IEnumWIA_DEV_INFO_Clone_Proxy,
        IEnumWIA_DEV_INFO_GetCount_Proxy,
    }
};

static const MIDL_SERVER_INFO IEnumWIA_DEV_INFO_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IEnumWIA_DEV_INFO_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IEnumWIA_DEV_INFO_table[] =
{
    IEnumWIA_DEV_INFO_Next_Stub,
    IEnumWIA_DEV_INFO_Skip_Stub,
    IEnumWIA_DEV_INFO_Reset_Stub,
    IEnumWIA_DEV_INFO_Clone_Stub,
    IEnumWIA_DEV_INFO_GetCount_Stub
};

static const CInterfaceStubVtbl _IEnumWIA_DEV_INFOStubVtbl =
{
    {
        &IID_IEnumWIA_DEV_INFO,
        &IEnumWIA_DEV_INFO_ServerInfo,
        8,
        &IEnumWIA_DEV_INFO_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

static const unsigned short IWiaPropertyStorage_FormatStringOffsetTable[] =
{
};

static const CINTERFACE_PROXY_VTABLE(3) _IWiaPropertyStorageProxyVtbl =
{
    {
        &IID_IWiaPropertyStorage,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaPropertyStorage_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaPropertyStorage_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaPropertyStorage_table[] =
{

};

static const CInterfaceStubVtbl _IWiaPropertyStorageStubVtbl =
{
    {
        &IID_IWiaPropertyStorage,
        &IWiaPropertyStorage_ServerInfo,
        3,
        &IWiaPropertyStorage_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

static const unsigned short IWiaItem_FormatStringOffsetTable[] =
{
};

static const CINTERFACE_PROXY_VTABLE(3) _IWiaItemProxyVtbl =
{
    {
        &IID_IWiaItem,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaItem_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaItem_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaItem_table[] =
{

};

static const CInterfaceStubVtbl _IWiaItemStubVtbl =
{
    {
        &IID_IWiaItem,
        &IWiaItem_ServerInfo,
        3,
        &IWiaItem_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

/*****************************************************************************
 * IWiaEventCallback interface
 */
static void __finally_IWiaEventCallback_ImageEventCallback_Proxy( struct __proxy_frame *__frame )
{
    NdrProxyFreeBuffer( __frame->This, &__frame->_StubMsg );
}

HRESULT STDMETHODCALLTYPE IWiaEventCallback_ImageEventCallback_Proxy(
    IWiaEventCallback* This,
    const GUID *pEventGUID,
    BSTR bstrEventDescription,
    BSTR bstrDeviceID,
    BSTR bstrDeviceDescription,
    DWORD dwDeviceType,
    BSTR bstrFullItemName,
    ULONG *pulEventType,
    ULONG ulReserved)
{
    struct __proxy_frame __f, * const __frame = &__f;
    HRESULT _RetVal;
    RPC_MESSAGE _RpcMessage;

    RpcExceptionInit( __proxy_filter, __finally_IWiaEventCallback_ImageEventCallback_Proxy );
    __frame->This = This;
    RpcTryExcept
    {
        NdrProxyInitialize(This, &_RpcMessage, &__frame->_StubMsg, &Object_StubDesc, 3);
        if (!pEventGUID) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        if (!pulEventType) RpcRaiseException(RPC_X_NULL_REF_POINTER);
        RpcTryFinally
        {
            __frame->_StubMsg.BufferLength = 44;
            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrEventDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574]);

            NdrUserMarshalBufferSize(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFullItemName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584]);

            NdrProxyGetBuffer(This, &__frame->_StubMsg);
            NdrSimpleStructMarshall(
                &__frame->_StubMsg,
                (unsigned char *)pEventGUID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[538]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrEventDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceID,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564]);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrDeviceDescription,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(DWORD *)__frame->_StubMsg.Buffer = dwDeviceType;
            __frame->_StubMsg.Buffer += sizeof(DWORD);

            NdrUserMarshalMarshall(
                &__frame->_StubMsg,
                (unsigned char *)&bstrFullItemName,
                (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584]);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = *pulEventType;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            *(ULONG *)__frame->_StubMsg.Buffer = ulReserved;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            NdrProxySendReceive(This, &__frame->_StubMsg);

            __frame->_StubMsg.BufferStart = _RpcMessage.Buffer;
            __frame->_StubMsg.BufferEnd   = __frame->_StubMsg.BufferStart + _RpcMessage.BufferLength;

            if ((_RpcMessage.DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
                NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[188]);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            *pulEventType = *(ULONG *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(ULONG);

            __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
            if (__frame->_StubMsg.Buffer + sizeof(HRESULT) > __frame->_StubMsg.BufferEnd)
            {
                RpcRaiseException(RPC_X_BAD_STUB_DATA);
            }
            _RetVal = *(HRESULT *)__frame->_StubMsg.Buffer;
            __frame->_StubMsg.Buffer += sizeof(HRESULT);

        }
        RpcFinally
        {
            __finally_IWiaEventCallback_ImageEventCallback_Proxy( __frame );
        }
        RpcEndFinally
    }
    RpcExcept(__frame->_StubMsg.dwStubPhase != PROXY_SENDRECEIVE)
    {
        NdrClearOutParameters( &__frame->_StubMsg, &__MIDL_TypeFormatString.Format[594], (void *)pulEventType );

        _RetVal = NdrProxyErrorHandler(RpcExceptionCode());
    }
    RpcEndExcept
    return _RetVal;
}

struct __frame_IWiaEventCallback_ImageEventCallback_Stub
{
    __DECL_EXCEPTION_FRAME
    MIDL_STUB_MESSAGE _StubMsg;
    IWiaEventCallback * _This;
    HRESULT _RetVal;
    const GUID * pEventGUID;
    BSTR bstrEventDescription;
    void *_p_bstrEventDescription;
    BSTR bstrDeviceID;
    void *_p_bstrDeviceID;
    BSTR bstrDeviceDescription;
    void *_p_bstrDeviceDescription;
    DWORD dwDeviceType;
    BSTR bstrFullItemName;
    void *_p_bstrFullItemName;
    ULONG * pulEventType;
    ULONG ulReserved;
};

static void __finally_IWiaEventCallback_ImageEventCallback_Stub( struct __frame_IWiaEventCallback_ImageEventCallback_Stub *__frame )
{

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrEventDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceID,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564]);

    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrDeviceDescription,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574]);


    NdrUserMarshalFree(
        &__frame->_StubMsg,
        (unsigned char *)&__frame->bstrFullItemName,
        (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584]);



}

void __RPC_STUB IWiaEventCallback_ImageEventCallback_Stub(
    IRpcStubBuffer* This,
    IRpcChannelBuffer *_pRpcChannelBuffer,
    PRPC_MESSAGE _pRpcMessage,
    DWORD* _pdwStubPhase)
{
    struct __frame_IWiaEventCallback_ImageEventCallback_Stub __f, * const __frame = &__f;

    __frame->_This = (IWiaEventCallback*)((CStdStubBuffer*)This)->pvServerObject;

    NdrStubInitialize(_pRpcMessage, &__frame->_StubMsg, &Object_StubDesc, _pRpcChannelBuffer);

    RpcExceptionInit( 0, __finally_IWiaEventCallback_ImageEventCallback_Stub );
    __frame->pEventGUID = 0;
    MIDL_memset(&__frame->bstrEventDescription, 0, sizeof(__frame->bstrEventDescription));
    __frame->_p_bstrEventDescription = &__frame->bstrEventDescription;
    MIDL_memset(&__frame->bstrDeviceID, 0, sizeof(__frame->bstrDeviceID));
    __frame->_p_bstrDeviceID = &__frame->bstrDeviceID;
    MIDL_memset(&__frame->bstrDeviceDescription, 0, sizeof(__frame->bstrDeviceDescription));
    __frame->_p_bstrDeviceDescription = &__frame->bstrDeviceDescription;
    MIDL_memset(&__frame->bstrFullItemName, 0, sizeof(__frame->bstrFullItemName));
    __frame->_p_bstrFullItemName = &__frame->bstrFullItemName;
    __frame->pulEventType = 0;

    RpcTryFinally
    {
        if ((_pRpcMessage->DataRepresentation & 0xffff) != NDR_LOCAL_DATA_REPRESENTATION)
            NdrConvert( &__frame->_StubMsg, &__MIDL_ProcFormatString.Format[188]);

        NdrSimpleStructUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->pEventGUID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[538],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrEventDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[554],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceID,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[564],
            0);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrDeviceDescription,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[574],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(DWORD) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->dwDeviceType = *(DWORD *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(DWORD);

        NdrUserMarshalUnmarshall(
            &__frame->_StubMsg,
            (unsigned char **)&__frame->_p_bstrFullItemName,
            (PFORMAT_STRING)&__MIDL_TypeFormatString.Format[584],
            0);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->pulEventType = (ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);

        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        if (__frame->_StubMsg.Buffer + sizeof(ULONG) > __frame->_StubMsg.BufferEnd)
        {
            RpcRaiseException(RPC_X_BAD_STUB_DATA);
        }
        __frame->ulReserved = *(ULONG *)__frame->_StubMsg.Buffer;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        *_pdwStubPhase = STUB_CALL_SERVER;

        __frame->_RetVal = __frame->_This->lpVtbl->ImageEventCallback(__frame->_This, __frame->pEventGUID, __frame->bstrEventDescription, __frame->bstrDeviceID, __frame->bstrDeviceDescription, __frame->dwDeviceType, __frame->bstrFullItemName, __frame->pulEventType, __frame->ulReserved);

        *_pdwStubPhase = STUB_MARSHAL;

        __frame->_StubMsg.BufferLength = 16;
        NdrStubGetBuffer(This, _pRpcChannelBuffer, &__frame->_StubMsg);
        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(ULONG *)__frame->_StubMsg.Buffer = *__frame->pulEventType;
        __frame->_StubMsg.Buffer += sizeof(ULONG);


        MIDL_memset(__frame->_StubMsg.Buffer, 0, (0x4 - (ULONG_PTR)__frame->_StubMsg.Buffer) & 0x3);
        __frame->_StubMsg.Buffer = (unsigned char *)(((ULONG_PTR)__frame->_StubMsg.Buffer + 3) & ~0x3);
        *(HRESULT *)__frame->_StubMsg.Buffer = __frame->_RetVal;
        __frame->_StubMsg.Buffer += sizeof(HRESULT);

    }
    RpcFinally
    {
        __finally_IWiaEventCallback_ImageEventCallback_Stub( __frame );
    }
    RpcEndFinally
    _pRpcMessage->BufferLength = __frame->_StubMsg.Buffer - (unsigned char *)_pRpcMessage->Buffer;
}

static const unsigned short IWiaEventCallback_FormatStringOffsetTable[] =
{
    188,  /* IWiaEventCallback::ImageEventCallback */
};

static const CINTERFACE_PROXY_VTABLE(4) _IWiaEventCallbackProxyVtbl =
{
    {
        &IID_IWiaEventCallback,
    },
    {
        IUnknown_QueryInterface_Proxy,
        IUnknown_AddRef_Proxy,
        IUnknown_Release_Proxy,
        IWiaEventCallback_ImageEventCallback_Proxy,
    }
};

static const MIDL_SERVER_INFO IWiaEventCallback_ServerInfo =
{
    &Object_StubDesc,
    0,
    __MIDL_ProcFormatString.Format,
    &IWiaEventCallback_FormatStringOffsetTable[-3],
    0,
    0,
    0,
    0
};

static const PRPC_STUB_FUNCTION IWiaEventCallback_table[] =
{
    IWiaEventCallback_ImageEventCallback_Stub
};

static const CInterfaceStubVtbl _IWiaEventCallbackStubVtbl =
{
    {
        &IID_IWiaEventCallback,
        &IWiaEventCallback_ServerInfo,
        4,
        &IWiaEventCallback_table[-3]
    },
    {
        CStdStubBuffer_METHODS
    }
};

static const USER_MARSHAL_ROUTINE_QUADRUPLE UserMarshalRoutines[] =
{
    {
        (USER_MARSHAL_SIZING_ROUTINE)BSTR_UserSize,
        (USER_MARSHAL_MARSHALLING_ROUTINE)BSTR_UserMarshal,
        (USER_MARSHAL_UNMARSHALLING_ROUTINE)BSTR_UserUnmarshal,
        (USER_MARSHAL_FREEING_ROUTINE)BSTR_UserFree
    },
    {
        (USER_MARSHAL_SIZING_ROUTINE)HWND_UserSize,
        (USER_MARSHAL_MARSHALLING_ROUTINE)HWND_UserMarshal,
        (USER_MARSHAL_UNMARSHALLING_ROUTINE)HWND_UserUnmarshal,
        (USER_MARSHAL_FREEING_ROUTINE)HWND_UserFree
    }
};

static const MIDL_STUB_DESC Object_StubDesc =
{
    0,
    NdrOleAllocate,
    NdrOleFree,
    {0}, 0, 0, 0, 0,
    __MIDL_TypeFormatString.Format,
    1, /* -error bounds_check flag */
    0x10001, /* Ndr library version */
    0,
    0x50100a4, /* MIDL Version 5.1.164 */
    0,
    UserMarshalRoutines,
    0,  /* notify & notify_flag routine table */
    1,  /* Flags */
    0,  /* Reserved3 */
    0,  /* Reserved4 */
    0   /* Reserved5 */
};

#if !defined(__RPC_WIN64__)
#error Currently only Wine and WIN32 are supported.
#endif

static const MIDL_PROC_FORMAT_STRING __MIDL_ProcFormatString =
{
    0,
    {
/* 0 (parameter lFlag) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 2 (parameter ppIEnum) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x14),	/* type offset = 20 */
/* 6 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 8 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x30),	/* type offset = 48 */
/* 12 (parameter ppWiaItemRoot) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x4c),	/* type offset = 76 */
/* 16 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 18 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x68),	/* type offset = 104 */
/* 22 (parameter lDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 24 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 26 (parameter pbstrDeviceID) */
        0x50,    /* FC_IN_OUT_PARAM */
        0x01,
        NdrFcShort(0x7c),	/* type offset = 124 */
/* 30 (parameter ppItemRoot) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x92),	/* type offset = 146 */
/* 34 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 36 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x96),	/* type offset = 150 */
/* 40 (parameter lDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 42 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 44 (parameter pbstrDeviceID) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0xa0),	/* type offset = 160 */
/* 48 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 50 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xa4),	/* type offset = 164 */
/* 54 (parameter lDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 56 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 58 (parameter lIntent) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 60 (parameter pItemRoot) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xae),	/* type offset = 174 */
/* 64 (parameter bstrFilename) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xc0),	/* type offset = 192 */
/* 68 (parameter pguidFormat) */
        0x50,    /* FC_IN_OUT_PARAM */
        0x01,
        NdrFcShort(0xdc),	/* type offset = 220 */
/* 72 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 74 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 76 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xe0),	/* type offset = 224 */
/* 80 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0xfc),	/* type offset = 252 */
/* 84 (parameter bstrCommandline) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x100),	/* type offset = 256 */
/* 88 (parameter bstrName) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x10a),	/* type offset = 266 */
/* 92 (parameter bstrDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x114),	/* type offset = 276 */
/* 96 (parameter bstrIcon) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x11e),	/* type offset = 286 */
/* 100 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 102 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 104 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x128),	/* type offset = 296 */
/* 108 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x144),	/* type offset = 324 */
/* 112 (parameter pIWiaEventCallback) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x148),	/* type offset = 328 */
/* 116 (parameter pEventObject) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x16c),	/* type offset = 364 */
/* 120 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 122 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 124 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x170),	/* type offset = 368 */
/* 128 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x18c),	/* type offset = 396 */
/* 132 (parameter pClsID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1a2),	/* type offset = 418 */
/* 136 (parameter bstrName) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1a6),	/* type offset = 422 */
/* 140 (parameter bstrDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1b0),	/* type offset = 432 */
/* 144 (parameter bstrIcon) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1ba),	/* type offset = 442 */
/* 148 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 150 (parameter hwndParent) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x1c4),	/* type offset = 452 */
/* 154 (parameter lFlags) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 156 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 158 (parameter celt) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 160 (parameter rgelt) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x1e0),	/* type offset = 480 */
/* 164 (parameter pceltFetched) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x1f6),	/* type offset = 502 */
/* 168 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 170 (parameter celt) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 172 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 174 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 176 (parameter ppIEnum) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x20c),	/* type offset = 524 */
/* 180 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 182 (parameter celt) */
        0x51,    /* FC_OUT_PARAM */
        0x01,
        NdrFcShort(0x210),	/* type offset = 528 */
/* 186 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 188 (parameter pEventGUID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x226),	/* type offset = 550 */
/* 192 (parameter bstrEventDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x22a),	/* type offset = 554 */
/* 196 (parameter bstrDeviceID) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x234),	/* type offset = 564 */
/* 200 (parameter bstrDeviceDescription) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x23e),	/* type offset = 574 */
/* 204 (parameter dwDeviceType) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 206 (parameter bstrFullItemName) */
        0x4d,    /* FC_IN_PARAM */
        0x01,
        NdrFcShort(0x248),	/* type offset = 584 */
/* 210 (parameter pulEventType) */
        0x50,    /* FC_IN_OUT_PARAM */
        0x01,
        NdrFcShort(0x252),	/* type offset = 594 */
/* 214 (parameter ulReserved) */
        0x4e,    /* FC_IN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
/* 216 (return value) */
        0x53,    /* FC_RETURN_PARAM_BASETYPE */
        0x08,    /* FC_LONG */
        0x0
    }
};

static const MIDL_TYPE_FORMAT_STRING __MIDL_TypeFormatString =
{
    0,
    {
        NdrFcShort(0x0),
/* 2 (IEnumWIA_DEV_INFO *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x5e38b83c),
        NdrFcShort(0x8cf1),
        NdrFcShort(0x11d1),
        0xbf,
        0x92,
        0x00,
        0x60,
        0x08,
        0x1e,
        0xd8,
        0x11,

/* 20 (IEnumWIA_DEV_INFO **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (2) */
/* 24 (unsigned short[]) */
        0x1b,	/* FC_CARRAY */
        0x1,	/* 1 */
        NdrFcShort(0x2),	/* 2 */
        0x9,	/* Corr desc: field clSize, FC_ULONG */
        0x0,	/* no operators */
        NdrFcShort(0xfffc),	/* offset = -4 */
        0x06,	/* FC_SHORT */
        0x5b,	/* FC_END */
/* 34 (FLAGGED_WORD_BLOB) */
        0x17,	/* FC_CSTRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0xfff2),	/* Offset= -14 (24) */
        0x08,	/* FC_LONG */
        0x08,	/* FC_LONG */
        0x5c,	/* FC_PAD */
        0x5b,	/* FC_END */
/* 44 (wireBSTR) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xfff4),	/* Offset= -12 (34) */
/* 48 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfff4),	/* Offset= -12 (44) */
/* 58 (IWiaItem *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x4db1ad10),
        NdrFcShort(0x3391),
        NdrFcShort(0x11d2),
        0x9a,
        0x33,
        0x00,
        0xc0,
        0x4f,
        0xa3,
        0x61,
        0x45,

/* 76 (IWiaItem **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (58) */
/* 80 (RemotableHandle) */
        0x2a,	/* FC_ENCAPSULATED_UNION */
        0x48,	/* Switch type= FC_LONG */
        NdrFcShort(0x4),	/* 4 */
        NdrFcShort(0x2),	/* 2 */
        NdrFcLong(0x48746457),	/* 1215587415 */
        NdrFcShort(0x8008),	/* Simple arm type: FC_LONG */
        NdrFcLong(0x52746457),	/* 1383359575 */
        NdrFcShort(0x8008),	/* Simple arm type: FC_LONG */
        NdrFcShort(0xffff),
/* 100 (wireHWND) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xffea),	/* Offset= -22 (80) */
/* 104 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfff4),	/* Offset= -12 (100) */
/* 114 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xffb2),	/* Offset= -78 (44) */
/* 124 (BSTR *) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xfff4),	/* Offset= -12 (114) */
/* 128 (IWiaItem *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x4db1ad10),
        NdrFcShort(0x3391),
        NdrFcShort(0x11d2),
        0x9a,
        0x33,
        0x00,
        0xc0,
        0x4f,
        0xa3,
        0x61,
        0x45,

/* 146 (IWiaItem **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (128) */
/* 150 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xffc6),	/* Offset= -58 (100) */
/* 160 (BSTR *) */
        0x11, 0x4,		/* FC_RP [allocated_on_stack] */
        NdrFcShort(0xffd0),	/* Offset= -48 (114) */
/* 164 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xffb8),	/* Offset= -72 (100) */
/* 174 (IWiaItem *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x4db1ad10),
        NdrFcShort(0x3391),
        NdrFcShort(0x11d2),
        0x9a,
        0x33,
        0x00,
        0xc0,
        0x4f,
        0xa3,
        0x61,
        0x45,

/* 192 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff64),	/* Offset= -156 (44) */
/* 202 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 208 (GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (202) */
        0x5b,	/* FC_END */
/* 220 (GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (208) */
/* 224 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff44),	/* Offset= -188 (44) */
/* 234 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 240 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (234) */
        0x5b,	/* FC_END */
/* 252 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (240) */
/* 256 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff24),	/* Offset= -220 (44) */
/* 266 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff1a),	/* Offset= -230 (44) */
/* 276 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff10),	/* Offset= -240 (44) */
/* 286 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xff06),	/* Offset= -250 (44) */
/* 296 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfefc),	/* Offset= -260 (44) */
/* 306 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 312 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (306) */
        0x5b,	/* FC_END */
/* 324 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (312) */
/* 328 (IWiaEventCallback *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0xae6287b0),
        NdrFcShort(0x0084),
        NdrFcShort(0x11d2),
        0x97,
        0x3b,
        0x00,
        0xa0,
        0xc9,
        0x06,
        0x8f,
        0x2e,

/* 346 (IUnknown *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x00000000),
        NdrFcShort(0x0000),
        NdrFcShort(0x0000),
        0xc0,
        0x00,
        0x00,
        0x00,
        0x00,
        0x00,
        0x00,
        0x46,

/* 364 (IUnknown **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (346) */
/* 368 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfeb4),	/* Offset= -332 (44) */
/* 378 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 384 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (378) */
        0x5b,	/* FC_END */
/* 396 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (384) */
/* 400 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 406 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (400) */
        0x5b,	/* FC_END */
/* 418 (const GUID *) */
        0x12, 0x0,		/* FC_UP */
        NdrFcShort(0xfff2),	/* Offset= -14 (406) */
/* 422 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe7e),	/* Offset= -386 (44) */
/* 432 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe74),	/* Offset= -396 (44) */
/* 442 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe6a),	/* Offset= -406 (44) */
/* 452 (HWND) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x1),	/* Function offset= 1 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfe98),	/* Offset= -360 (100) */
/* 462 (IWiaPropertyStorage *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x98b5e8a0),
        NdrFcShort(0x29cc),
        NdrFcShort(0x491a),
        0xaa,
        0xc0,
        0xe6,
        0xdb,
        0x4f,
        0xdc,
        0xce,
        0xb6,

/* 480 (IWiaPropertyStorage **) */
        0x21,	/* FC_BOGUS_ARRAY */
        0x3,	/* 3 */
        NdrFcShort(0x0),	/* 0 */
        0x29,	/* Corr desc: parameter celt, FC_ULONG */
        0x0,	/* no operators */
        NdrFcShort(0x8),	/* offset = 8 */
        0x29,	/* Corr desc: parameter pceltFetched, FC_ULONG */
        0x54,	/* FC_DEREFERENCE */
        NdrFcShort(0x18),	/* offset = 24 */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xffe0),	/* Offset= -32 (462) */
        0x5c,	/* FC_PAD */
        0x5b,	/* FC_END */
/* 498 */
        0x11, 0x0,	/* FC_RP */
        NdrFcShort(0xffec),	/* Offset= -20 (480) */
/* 502 (ULONG *) */
        0x11, 0xc,	/* FC_RP [allocated_on_stack] [simple_pointer] */
        0x09,	/* FC_ULONG */
        0x5c,	/* FC_PAD */
/* 506 (IEnumWIA_DEV_INFO *) */
        0x2f,	/* FC_IP */
        0x5a,	/* FC_CONSTANT_IID */
        NdrFcLong(0x5e38b83c),
        NdrFcShort(0x8cf1),
        NdrFcShort(0x11d1),
        0xbf,
        0x92,
        0x00,
        0x60,
        0x08,
        0x1e,
        0xd8,
        0x11,

/* 524 (IEnumWIA_DEV_INFO **) */
        0x11, 0x14,		/* FC_RP [allocated_on_stack] [pointer_deref] */
        NdrFcShort(0xffec),	/* Offset= -20 (506) */
/* 528 (ULONG *) */
        0x11, 0xc,	/* FC_RP [allocated_on_stack] [simple_pointer] */
        0x09,	/* FC_ULONG */
        0x5c,	/* FC_PAD */
/* 532 (byte[8]) */
        0x1d,	/* FC_SMFARRAY */
        0x0,	/* 0 */
        NdrFcShort(0x8),	/* 8 */
        0x01,	/* FC_BYTE */
        0x5b,	/* FC_END */
/* 538 (const GUID) */
        0x15,	/* FC_STRUCT */
        0x3,	/* 3 */
        NdrFcShort(0x10),	/* 16 */
        0x08,	/* FC_LONG */
        0x06,	/* FC_SHORT */
        0x06,	/* FC_SHORT */
        0x4c,	/* FC_EMBEDDED_COMPLEX */
        0x0,
        NdrFcShort(0xfff1),	/* Offset= -15 (532) */
        0x5b,	/* FC_END */
/* 550 (const GUID *) */
        0x11, 0x0,		/* FC_RP */
        NdrFcShort(0xfff2),	/* Offset= -14 (538) */
/* 554 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfdfa),	/* Offset= -518 (44) */
/* 564 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfdf0),	/* Offset= -528 (44) */
/* 574 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfde6),	/* Offset= -538 (44) */
/* 584 (BSTR) */
        0xb4,	/* FC_USER_MARSHAL */
        0x83,	/* Alignment= 3, Flags= 80 */
        NdrFcShort(0x0),	/* Function offset= 0 */
        NdrFcShort(0x8),	/* 8 */
        NdrFcShort(0x0),	/* 0 */
        NdrFcShort(0xfddc),	/* Offset= -548 (44) */
/* 594 (ULONG *) */
        0x11, 0x8,	/* FC_RP [simple_pointer] */
        0x09,	/* FC_ULONG */
        0x5c,	/* FC_PAD */
        0x0
    }
};

static const CInterfaceProxyVtbl* const _sti_wia_ProxyVtblList[] =
{
    (const CInterfaceProxyVtbl*)&_IWiaItemProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IWiaDevMgrProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IEnumWIA_DEV_INFOProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IWiaPropertyStorageProxyVtbl,
    (const CInterfaceProxyVtbl*)&_IWiaEventCallbackProxyVtbl,
    0
};

static const CInterfaceStubVtbl* const _sti_wia_StubVtblList[] =
{
    &_IWiaItemStubVtbl,
    &_IWiaDevMgrStubVtbl,
    &_IEnumWIA_DEV_INFOStubVtbl,
    &_IWiaPropertyStorageStubVtbl,
    &_IWiaEventCallbackStubVtbl,
    0
};

static PCInterfaceName const _sti_wia_InterfaceNamesList[] =
{
    "IWiaItem",
    "IWiaDevMgr",
    "IEnumWIA_DEV_INFO",
    "IWiaPropertyStorage",
    "IWiaEventCallback",
    0
};

static int __stdcall _sti_wia_IID_Lookup(const IID* pIID, int* pIndex)
{
    int low = 0, high = 4;

    while (low <= high)
    {
        int pos = (low + high) / 2;
        int res = IID_GENERIC_CHECK_IID(_sti_wia, pIID, pos);
        if (!res) { *pIndex = pos; return 1; }
        if (res > 0) low = pos + 1;
        else high = pos - 1;
    }
    return 0;
}

const ExtendedProxyFileInfo sti_wia_ProxyFileInfo DECLSPEC_HIDDEN =
{
    (const PCInterfaceProxyVtblList*)_sti_wia_ProxyVtblList,
    (const PCInterfaceStubVtblList*)_sti_wia_StubVtblList,
    _sti_wia_InterfaceNamesList,
    0,
    _sti_wia_IID_Lookup,
    5,
    1,
    0,
    0,
    0,
    0
};

#endif /* _WIN64 */
